<!doctype html><html class=min-height-full lang=en><meta charset=utf-8><meta content="width=device-width,initial-scale=1,shrink-to-fit=no" name=viewport><meta content="light dark" name=color-scheme><link href=/favicon.ico rel=icon type=image/x-icon><link href=//fonts.gstatic.com/s/atkinsonhyperlegible/v10/9Bt23C1KxNDXMspQ1lPyU89-1h6ONRlW45G04pIo.woff2 rel=preload type=font/woff2 as=font crossorigin><link href=/feed.xml rel=alternate type=application/atom+xml title="Alex Saveau"><title>The fastest way to copy a file | Alex Saveau</title><meta content="Jekyll v4.3.2" name=generator><meta content="The fastest way to copy a file" property=og:title><meta content="Alex Saveau" name=author><meta content=en_US property=og:locale><meta content="Update: the ideas from this post have been implemented in Fast Unix Commands." name=description><meta content="Update: the ideas from this post have been implemented in Fast Unix Commands." property=og:description><link href=https://alexsaveau.dev/blog/performance/files/kernel/the-fastest-way-to-copy-a-file rel=canonical><meta content=https://alexsaveau.dev/blog/performance/files/kernel/the-fastest-way-to-copy-a-file property=og:url><meta content="Alex Saveau" property=og:site_name><meta content=https://alexsaveau.dev/assets/resized/performance/file-cp-benches/1kib-memcache2-min.svg property=og:image><meta content=article property=og:type><meta content=2021-11-26T00:00:00+00:00 property=article:published_time><meta content=summary_large_image name=twitter:card><meta content=https://alexsaveau.dev/assets/resized/performance/file-cp-benches/1kib-memcache2-min.svg property=twitter:image><meta content="The fastest way to copy a file" property=twitter:title><meta content=@SUPERCILEX name=twitter:site><meta content=@SUPERCILEX name=twitter:creator><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"Alex Saveau"},"dateModified":"2025-01-09T02:18:57+00:00","datePublished":"2021-11-26T00:00:00+00:00","description":"Update: the ideas from this post have been implemented in Fast Unix Commands.","headline":"The fastest way to copy a file","image":"https://alexsaveau.dev/assets/resized/performance/file-cp-benches/1kib-memcache2-min.svg","mainEntityOfPage":{"@type":"WebPage","@id":"https://alexsaveau.dev/blog/performance/files/kernel/the-fastest-way-to-copy-a-file"},"url":"https://alexsaveau.dev/blog/performance/files/kernel/the-fastest-way-to-copy-a-file"}</script><script>window.addEventListener("DOMContentLoaded",()=>{for(let e of document.querySelectorAll(".loads")){var o=()=>{e.classList.remove("loads")};e.complete?o():(e.onload=o,e.onerror=o)}})</script><noscript><style>.loads{animation:none!important;background-color:unset!important}</style></noscript><link href=//fonts.gstatic.com/s/firacode/v17/uU9NCBsR6Z2vfE9aq3bh3dSD.woff2 rel=preload type=font/woff2 as=font crossorigin><style>@keyframes tooltip-appear{0%{opacity:0}to{opacity:1}}@keyframes pulse{0%,to{opacity:1}50%{opacity:.33}}:root{--progress-color:gray;--blockquote-color:#6a737d;--blockquote-boarder-color:#959da5;--code-background-color:rgba(0, 0, 0, 0.05);--hr-color:gray;--footer-color:white;--loading-pulse-color:#b0b0b0}@font-face{font-family:"Fira Code";font-style:normal;font-weight:475;font-display:swap;src:url(//fonts.gstatic.com/s/firacode/v17/uU9NCBsR6Z2vfE9aq3bh3dSD.woff2) format("woff2");unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+2000-206F,U+2074,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD}.article{overflow-wrap:break-word}.article .caption{font-size:1rem;margin:-1.5em 0 0}.article .caption code{font-size:.875rem}.article h2,.article h3{margin:1.5em 0-.5em}.article h2{font-size:1.875rem}.article h3{font-size:1.5rem}.article p{font-size:1.313rem;margin:.95em 0 1.2em}.article p.caption{text-align:center}.article img.article-image{width:100%;height:auto}.article strong{font-size:1.25rem}.article code{font-family:"Fira Code",monospace;font-size:1rem;background-color:var(--code-background-color);border-radius:3px;padding:2px 4px}.article blockquote{border-left:4px solid var(--blockquote-boarder-color);padding-left:16px;margin-bottom:16px;margin-left:0;margin-right:0}.article blockquote :not(a){color:var(--blockquote-color)}.article ol,.article ul{font-size:1.313rem;padding-left:32px;margin-bottom:16px}.header-link{visibility:hidden}h2:hover .header-link,h3:hover .header-link{visibility:visible}@media (prefers-color-scheme:dark){:root{--progress-color:whitesmoke;--blockquote-color:#dadada;--blockquote-boarder-color:#dadada;--code-background-color:rgba(255,255,255,0.15)}.article .caption{color:#dadada}.article p{color:#ededed}}.octicon{display:inline-block;fill:currentColor;vertical-align:text-bottom}html{font-family:sans-serif;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}body{margin:0;font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Helvetica,Arial,sans-serif,"Apple Color Emoji","Segoe UI Emoji";line-height:1.5;color:#24292e;background-color:#fff;font-family:Atkinson Hyperlegible,sans-serif;font-size:1em}footer{display:block;display:flex;padding:5px;align-items:center;background-color:var(--footer-color)}a{background-color:transparent;color:#0366d6;text-decoration:none}a:active,a:hover{outline-width:0}strong{font-weight:600}h1{margin:.67em 0}small{font-size:90%}sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline;top:-.5em}img{border-style:none}svg:not(:root){overflow:hidden}code{font-family:SFMono-Regular,Consolas,"Liberation Mono",Menlo,monospace;font-size:.75rem}hr{box-sizing:content-box;height:0;margin:15px 0;overflow:hidden;background:0 0;border:0;border-bottom:1px solid #dfe2e5;border:1.5px solid var(--hr-color);border-radius:1.5px;background-color:var(--hr-color)}::-webkit-input-placeholder{color:inherit;opacity:.54}::-webkit-file-upload-button{-webkit-appearance:button;font:inherit}*{box-sizing:border-box}a:hover{text-decoration:underline}hr::after,hr::before{display:table;content:""}hr::after{clear:both}h1,h2,h3,ol,p,ul{margin-top:0;margin-bottom:0}h1,h2,h3{font-size:2rem;font-weight:600}h2,h3{font-size:1.5rem}h3{font-size:1.25rem}ol,p,ul{margin-bottom:10px}blockquote{margin:0}ol,ul{padding-left:0;margin-bottom:0}:-ms-input-placeholder{color:#6a737d;opacity:1}::-ms-input-placeholder{color:#6a737d;opacity:1}:checked+.radio-label{position:relative;z-index:1;border-color:#0366d6}@media (min-width:768px){.col-md-5{width:41.66667%}.col-md-7{width:58.33333%}}@media (min-width:1012px){.col-lg-4{width:33.33333%}.col-lg-8{width:66.66667%}}@media (min-width:1280px){.col-xl-3{width:25%}.col-xl-9{width:75%}}.tooltipped{position:relative}.tooltipped::after,.tooltipped::before{position:absolute;display:none;pointer-events:none;opacity:0}.tooltipped::after{z-index:1000000;padding:.5em .75em;font:11px/1.5 -apple-system,BlinkMacSystemFont,"Segoe UI",Helvetica,Arial,sans-serif,"Apple Color Emoji","Segoe UI Emoji";-webkit-font-smoothing:subpixel-antialiased;color:#fff;text-align:center;text-decoration:none;text-shadow:none;text-transform:none;letter-spacing:normal;word-wrap:break-word;white-space:pre;content:attr(aria-label);background:#1b1f23;border-radius:6px}.tooltipped::before{z-index:1000001;width:0;height:0;color:#1b1f23;content:"";border:6px solid transparent}.tooltipped:active::after,.tooltipped:active::before,.tooltipped:focus::after,.tooltipped:focus::before,.tooltipped:hover::after,.tooltipped:hover::before{display:inline-block;text-decoration:none;animation-name:tooltip-appear;animation-duration:.1s;animation-fill-mode:forwards;animation-timing-function:ease-in;animation-delay:.4s}.tooltipped-se::after{top:100%;margin-top:6px}.tooltipped-se::before{top:auto;right:50%;bottom:-7px;margin-right:-6px;border-bottom-color:#1b1f23}.tooltipped-se::after{right:auto;left:50%;margin-left:-16px}.border-top{border-top:1px solid #e1e4e8!important}@media (min-width:768px){.border-md-right{border-right:1px solid #e1e4e8!important}.border-md-bottom{border-bottom:1px solid #e1e4e8!important}.border-md-top-0{border-top:0!important}}.circle{border-radius:50%!important}.border-gray-light{border-color:#eaecef!important}.bg-white{background-color:#fff!important}.bg-gray-light{background-color:#fafbfc!important}.text-gray{color:#586069!important}.flex-wrap{flex-wrap:wrap!important}.flex-items-start{align-items:flex-start!important}.flex-items-center{align-items:center!important}.flex-self-stretch{align-self:stretch!important}.v-align-middle{vertical-align:middle!important}.mr-2{margin-right:8px!important}.mx-auto{margin-right:auto!important;margin-left:auto!important}.px-4{padding-right:24px!important;padding-left:24px!important}.f4{font-size:1rem!important}@media (min-width:768px){.px-md-6{padding-right:40px!important;padding-left:40px!important}.f4{font-size:1rem!important}}.f5{font-size:.875rem!important}.f00-light{font-size:2.5rem!important;font-weight:300!important}@media (min-width:768px){.f00-light{font-size:3rem!important}}.f2-light{font-size:1.375rem!important;font-weight:300!important}.lh-condensed{line-height:1.25!important}.d-flex{display:flex!important}.d-none{display:none!important}@font-face{font-family:Inter;font-style:normal;font-weight:400;src:local("Inter"),local("Inter-Regular"),url(/fonts/Inter-Regular.woff) format("woff");font-display:swap}@font-face{font-family:Inter;font-style:normal;font-weight:500;src:local("Inter Medium"),local("Inter-Medium"),url(/fonts/Inter-Medium.woff) format("woff");font-display:swap}@font-face{font-family:Inter;font-style:normal;font-weight:600;src:local("Inter Bold"),local("Inter-Bold"),url(/fonts/Inter-Bold.woff) format("woff");font-display:swap}.mb-2{margin-bottom:8px!important}.mb-3{margin-bottom:16px!important}.mb-5{margin-bottom:32px!important}.mb-6{margin-bottom:40px!important}.py-6{padding-top:40px!important;padding-bottom:40px!important}@font-face{font-family:"Atkinson Hyperlegible";font-style:normal;font-weight:400;font-display:swap;src:url(//fonts.gstatic.com/s/atkinsonhyperlegible/v10/9Bt23C1KxNDXMspQ1lPyU89-1h6ONRlW45G04pIo.woff2) format("woff2");unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+2000-206F,U+2074,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD}footer small{width:100%}footer small:last-child{text-align:end}.min-height-full{min-height:100vh}.icon-color{fill:#24292e!important}.loads{animation-duration:2s;animation:2s cubic-bezier(.4,0,.6,1) infinite pulse;animation-timing-function:cubic-bezier(.4,0,.6,1);animation-iteration-count:infinite;animation-name:pulse;background-color:var(--loading-pulse-color)}@media (min-width:768px){.f2-light{font-size:1.5rem!important}.d-md-flex{display:flex!important}#masthead{position:fixed;width:min-content}.masthead-name-mobile{display:none}}@media (max-width:768px){.masthead-mini{padding-top:10px!important;padding-bottom:10px!important}.masthead-mini-container{display:flex;align-items:center}.masthead-profile{width:80px;height:80px;margin-bottom:0!important}.masthead-intro{padding-left:24px}.masthead-name{display:none}.masthead-bio{margin-bottom:0!important}.masthead-metadata{display:none}}@media (min-width:1942px){.masthead{max-width:400px}.content-container{width:100%}}@media (prefers-color-scheme:dark){:root{--hr-color:whitesmoke;--footer-color:black;--loading-pulse-color:#383838}a{color:unset!important;text-decoration:underline}.bg-white{background-color:#4f565d!important}.bg-gray-light{background-color:#2f363d!important}.border-gray-light{border-color:transparent!important}.text-gray{color:#d0d8e1!important}.border-md-bottom{border:0!important}.masthead{background-color:#24292e!important}.scoped-text-defaults,.text-defaults,.text-defaults *{color:#fff!important}.icon-color{fill:#fff!important}}</style><body class=min-height-full id=top><div class="min-height-full bg-gray-light border-md-bottom d-md-flex"><div class="px-4 px-lg-7 py-6 bg-white border-gray-light border-md-right col-lg-4 col-md-5 col-xl-3 flex-self-stretch masthead masthead-mini px-md-6"><div class=masthead-mini-container id=masthead><a href=/ ><picture><source sizes=150px srcset="/assets/resized/me2-240-min.avif 240w, /assets/resized/me2-320-min.avif 320w, /assets/resized/me2-480-min.avif 480w, /assets/resized/me2-800-min.avif 800w, /assets/resized/me2-min.avif 1528w" type=image/avif><source sizes=150px srcset="/assets/resized/me2-240-min.webp 240w, /assets/resized/me2-320-min.webp 320w, /assets/resized/me2-480-min.webp 480w, /assets/resized/me2-800-min.webp 800w, /assets/resized/me2-min.webp 1528w" type=image/webp><source sizes=150px srcset="/assets/resized/me2-240-min.jpg 240w, /assets/resized/me2-320-min.jpg 320w, /assets/resized/me2-480-min.jpg 480w, /assets/resized/me2-800-min.jpg 800w, /assets/resized/me2-min.jpg 1528w" type=image/jpeg><source sizes=150px srcset="/assets/resized/me2-240.jpg 240w, /assets/resized/me2-320.jpg 320w, /assets/resized/me2-480.jpg 480w, /assets/resized/me2-800.jpg 800w, /assets/me2.jpg 1528w"><img alt="Profile Picture" class="mb-3 circle loads masthead-profile" height=150 loading=lazy src=/assets/resized/me2-240.jpg width=150></picture></a><div class=masthead-intro><h1 class="text-defaults lh-condensed mb-2 masthead-name">Alex Saveau</h1><h2 class="text-defaults lh-condensed mb-2 masthead-name-mobile">Alex Saveau</h2><p class="mb-3 f4 masthead-bio text-gray" id=bio>Relentless efficiency</div><div class="f4 masthead-metadata"><div class="text-defaults d-flex flex-items-center mb-3"><svg height=20 viewBox="0 0 16 16" aria-label=GitHub class="icon-color mr-2 octicon v-align-middle octicon-mark-github" role=img version=1.1 width=20><path d="M8 0c4.42 0 8 3.58 8 8a8.013 8.013 0 0 1-5.45 7.59c-.4.08-.55-.17-.55-.38 0-.27.01-1.13.01-2.2 0-.75-.25-1.23-.54-1.48 1.78-.2 3.65-.88 3.65-3.95 0-.88-.31-1.59-.82-2.15.08-.2.36-1.02-.08-2.12 0 0-.67-.22-2.2.82-.64-.18-1.32-.27-2-.27-.68 0-1.36.09-2 .27-1.53-1.03-2.2-.82-2.2-.82-.44 1.1-.16 1.92-.08 2.12-.51.56-.82 1.28-.82 2.15 0 3.06 1.86 3.75 3.64 3.95-.23.2-.44.55-.51 1.07-.46.21-1.61.55-2.33-.66-.15-.24-.6-.83-1.23-.82-.67.01-.27.38.01.53.34.19.73.9.82 1.13.16.45.68 1.31 2.69.94 0 .67.01 1.3.01 1.49 0 .21-.15.45-.55.38A7.995 7.995 0 0 1 0 8c0-4.42 3.58-8 8-8Z"></path></svg> <a href=//github.com/SUPERCILEX>@SUPERCILEX</a></div><div class="text-defaults d-flex flex-items-center mb-3"><svg height=20 viewBox="0 0 16 16" aria-label=email class="icon-color mr-2 octicon v-align-middle octicon-mail" role=img version=1.1 width=20><path d="M1.75 2h12.5c.966 0 1.75.784 1.75 1.75v8.5A1.75 1.75 0 0 1 14.25 14H1.75A1.75 1.75 0 0 1 0 12.25v-8.5C0 2.784.784 2 1.75 2ZM1.5 12.251c0 .138.112.25.25.25h12.5a.25.25 0 0 0 .25-.25V5.809L8.38 9.397a.75.75 0 0 1-.76 0L1.5 5.809v6.442Zm13-8.181v-.32a.25.25 0 0 0-.25-.25H1.75a.25.25 0 0 0-.25.25v.32L8 7.88Z"></path></svg> <a href=mailto:saveau.alexandre@gmail.com>saveau.alexandre@gmail.com</a></div><div class="flex-items-start d-flex flex-wrap"><div class=mb-3><a href=//stackoverflow.com/u/4548500 class="tooltipped tooltipped-se" aria-label="Stack Overflow: 4548500"><svg height=24 viewBox="0 0 120 120" fill=#959da5 xmlns=http://www.w3.org/2000/svg><path d="M84.4 93.8V70.6h7.7v30.9H22.6V70.6h7.7v23.2z" class=st0 /><path d="M38.8 68.4l37.8 7.9 1.6-7.6-37.8-7.9-1.6 7.6zm5-18l35 16.3 3.2-7-35-16.4-3.2 7.1zm9.7-17.2l29.7 24.7 4.9-5.9-29.7-24.7-4.9 5.9zm19.2-18.3l-6.2 4.6 23 31 6.2-4.6-23-31zM38 86h38.6v-7.7H38V86z" class=st1 /></svg><span class=d-none>Stack Overflow</span></a></div></div></div></div></div><div class="px-4 px-lg-7 py-6 border-md-top-0 border-top col-lg-8 col-md-7 col-xl-9 content-container" id=article><div class=mx-auto style=max-width:900px><div class="f4 mb-6"><div class="f4 scoped-text-defaults"><p class=f5><a href=/blog class="text-defaults d-flex flex-items-center"><svg height=16 viewBox="0 0 16 16" aria-label=include.parent class="icon-color mr-2 octicon v-align-middle octicon-chevron-left" role=img version=1.1 width=16><path d="M9.78 12.78a.75.75 0 0 1-1.06 0L4.47 8.53a.75.75 0 0 1 0-1.06l4.25-4.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042L6.06 8l3.72 3.72a.75.75 0 0 1 0 1.06Z"></path></svg>Blog</a><h1 class="text-defaults lh-condensed f00-light" style=font-weight:600!important>The fastest way to copy a file</h1><h2 class="lh-condensed f2-light text-gray" style=font-weight:400!important>With benchmarks!</h2><p class="text-gray mb-5">Published Nov 26, 2021 • Last updated Jan 09, 2025 • 2 min read<div class=article><p><a href=/assets/resized/performance/file-cp-benches/1kib-memcache2-min.svg><img alt="Benchmark of copying 1 KiB files with the Kernel cache enabled" class=article-image height=400 loading=lazy src=/assets/resized/performance/file-cp-benches/1kib-memcache2-min.svg width=1280></a><div class=text-gray><p class=caption>TL;DR: use the <code>copy_file_range</code> syscall if you can</div><br><blockquote><p>Update: the ideas from this post have been implemented in <a href=//github.com/SUPERCILEX/fuc/tree/master/cpz>Fast Unix Commands</a>.</blockquote><p>I’m on a mission to find the fastest way to copy and delete files on a modern machine. I thought a quick Google search would reveal the answer, but I only found this <a href=//stackoverflow.com/questions/7463689/most-efficient-way-to-copy-a-file-in-linux>Stack Overflow post</a> with people’s opinion on the matter (but no proof), a <a href=//lwn.net/Articles/789623/ >discussion</a> on what the kernel can do to improve performance, and various articles claiming you should tar directories to copy them faster (there’s no chance of that being faster than a properly written parallel cp implementation).<p>The only way to get an objective answer is by writing benchmarks, so <a href=//github.com/SUPERCILEX/fuc/blob/fb0ec728dbd323f351d05e1d338b8f669e0d5b5d/cpz/benches/copy_methods.rs>here they are</a>. 😁 The results will be highly dependent on your specific system, so I would recommend simply running those benchmarks yourself if you’re curious. However, I’ll share my findings from running these on my ext4 XPS 17 and an APFS Macbook.<h2 id=findings>Findings <a href=#findings class=header-link>#</a></h2><p>Honestly, the results are a little disappointing. With very small files (1 KiB), the fastest option is to use <code class="highlighter-rouge language-plaintext">copy_file_range</code><sup id=fnref:1kib-memcache role=doc-noteref><a href=#fn:1kib-memcache class=footnote rel=footnote>1</a></sup>, but that’s expected since you’re going from four syscalls (<code class="highlighter-rouge language-plaintext">open</code>/<code class="highlighter-rouge language-plaintext">read</code> /<code class="highlighter-rouge language-plaintext">write</code>/<code class="highlighter-rouge language-plaintext">close</code>) to one. However, running the same benchmark with medium-sized files (1 MiB) results in a win for the <code class="highlighter-rouge language-plaintext">mmap</code> variant<sup id=fnref:1mib-memcache role=doc-noteref><a href=#fn:1mib-memcache class=footnote rel=footnote>2</a></sup> (with direct I/O too<sup id=fnref:1mib-uncached role=doc-noteref><a href=#fn:1mib-uncached class=footnote rel=footnote>3</a></sup>). Finally, with large files (32 MiB), the method of copy doesn’t matter since the disk can’t keep up<sup id=fnref:32mib-memcache role=doc-noteref><a href=#fn:32mib-memcache class=footnote rel=footnote>4</a></sup>.<p>All is not lost though, as I did learn a few things:<ul><li>Write only <code class="highlighter-rouge language-plaintext">mmap</code>s are consistently terrible, don’t use them. If you want to use <code class="highlighter-rouge language-plaintext">mmap</code>, set up a read-only <code class="highlighter-rouge language-plaintext">mmap</code> for the <em>from</em> file and then copy the bytes using <code class="highlighter-rouge language-plaintext">write</code> with the memory address of your <code class="highlighter-rouge language-plaintext">mmap</code> as the buffer for the <em>to</em> file.<li><code class="highlighter-rouge language-plaintext">copyfile</code> performs extraordinarily well on macOS, presumably because APFS supports copy acceleration (meaning the files aren’t actually copied, instead only needing to update copy-on-write metadata). I’m guessing if my machine used Btrfs instead of ext4, I would see similar gains.<li>Curiously enough, using <code class="highlighter-rouge language-plaintext">fadvise</code> with <code class="highlighter-rouge language-plaintext">POSIX_FADV_SEQUENTIAL</code> seemed to have no effect or make performance slightly worse. I’m not quite sure why that is — if I had to guess, I would say that being I/O bound means it doesn’t matter how far the kernel tries to read ahead because it’ll never fill its readahead buffer.<li>Using <code class="highlighter-rouge language-plaintext">fallocate</code> or <code class="highlighter-rouge language-plaintext">truncate</code> to set the file length upfront (and thereby minimize metadata updates) improves performance on Linux, but seems to have no effect or slightly worsen performance on macOS.</ul><p>My main takeaway is that <strong>you should just use <a href=//man7.org/linux/man-pages/man2/copy_file_range.2.html><code class="highlighter-rouge language-plaintext">copy_file_range</code></a> (or <a href=//developer.apple.com/library/archive/documentation/System/Conceptual/ManPages_iPhoneOS/man3/copyfile.3.html><code class="highlighter-rouge language-plaintext">copyfile</code></a> on macOS) where possible</strong> since it’s good enough, will handle stuff like <code class="highlighter-rouge language-plaintext">fadvise</code> and <code class="highlighter-rouge language-plaintext">fallocate</code> for you, uses copy acceleration when the file system supports it, and will come with free improvements as the kernel is updated.<hr><h2 id=sample-benchmarks>Sample benchmarks <a href=#sample-benchmarks class=header-link>#</a></h2><h3 id=fn:1kib-memcache>Copying 1 KiB files with the Kernel cache enabled <a href=#fn:1kib-memcache class=header-link>#</a></h3><p><a href=/assets/resized/performance/file-cp-benches/1kib-memcache2-min.svg><img alt="Benchmark results" class=article-image height=400 loading=lazy src=/assets/resized/performance/file-cp-benches/1kib-memcache2-min.svg width=1280></a><p><a href=#fnref:1kib-memcache class=reversefootnote role=doc-backlink>↩</a><h3 id=fn:1mib-memcache>Copying 1 MiB files with the Kernel cache enabled <a href=#fn:1mib-memcache class=header-link>#</a></h3><p><a href=/assets/resized/performance/file-cp-benches/1mib-memcache2-min.svg><img alt="Benchmark results" class=article-image height=450 loading=lazy src=/assets/resized/performance/file-cp-benches/1mib-memcache2-min.svg width=1280></a><p><a href=#fnref:1mib-memcache class=reversefootnote role=doc-backlink>↩</a><h3 id=fn:1mib-uncached>Copying 1 MiB files with the Kernel cache disabled for reads <a href=#fn:1mib-uncached class=header-link>#</a></h3><p><a href=/assets/resized/performance/file-cp-benches/1mib-uncached2-min.svg><img alt="Benchmark results" class=article-image height=400 loading=lazy src=/assets/resized/performance/file-cp-benches/1mib-uncached2-min.svg width=1280></a><p><a href=#fnref:1mib-uncached class=reversefootnote role=doc-backlink>↩</a><h3 id=fn:32mib-memcache>Copying 32 MiB files with the Kernel cache enabled <a href=#fn:32mib-memcache class=header-link>#</a></h3><p><a href=/assets/resized/performance/file-cp-benches/32mib-memcache2-min.svg><img alt="Benchmark results" class=article-image height=400 loading=lazy src=/assets/resized/performance/file-cp-benches/32mib-memcache2-min.svg width=1280></a><p>Ignore the extra probability of <code class="highlighter-rouge language-plaintext">copy_file_range</code> completing in 20ms, that’s just happens to be the first benchmark that ran before the system reached saturation.<p><a href=#fnref:32mib-memcache class=reversefootnote role=doc-backlink>↩</a></p><style>.footnotes{display:none}</style><div class=footnotes role=doc-endnotes><ol><li id=fn:1kib-memcache role=doc-endnote><p><a href=#fnref:1kib-memcache class=reversefootnote role=doc-backlink>↩</a><li id=fn:1mib-memcache role=doc-endnote><p><a href=#fnref:1mib-memcache class=reversefootnote role=doc-backlink>↩</a><li id=fn:1mib-uncached role=doc-endnote><p><a href=#fnref:1mib-uncached class=reversefootnote role=doc-backlink>↩</a><li id=fn:32mib-memcache role=doc-endnote><p><a href=#fnref:32mib-memcache class=reversefootnote role=doc-backlink>↩</a></ol></div></div></div></div></div></div></div><footer class=text-defaults><small>Copyright © 2018-2025 Alex Saveau</small> <small><a href=//github.com/SUPERCILEX/personal-website>Source</a> | <a href=//twitter.com/SUPERCILEX>Twitter</a> | <a href=#top>Back to top</a></small></footer>