<!doctype html><html class=min-height-full lang=en><meta charset=utf-8><meta content="width=device-width,initial-scale=1,shrink-to-fit=no" name=viewport><meta content="light dark" name=color-scheme><link href=/favicon.ico rel=icon type=image/x-icon><link href=//fonts.gstatic.com/s/atkinsonhyperlegible/v10/9Bt23C1KxNDXMspQ1lPyU89-1h6ONRlW45G04pIo.woff2 rel=preload type=font/woff2 as=font crossorigin><link href=/feed.xml rel=alternate type=application/atom+xml title="Alex Saveau"><title>Automate deleting old Google emails and calendar events | Alex Saveau</title><meta content="Jekyll v4.3.2" name=generator><meta content="Automate deleting old Google emails and calendar events" property=og:title><meta content="Alex Saveau" name=author><meta content=en_US property=og:locale><meta content="Google introduced auto deletion for web, YouTube, and location activity back in 2019, but hasn’t come out with official solutions for their other products yet. Notably, gmail and gcal have data that likely isn’t needed after some number of months." name=description><meta content="Google introduced auto deletion for web, YouTube, and location activity back in 2019, but hasn’t come out with official solutions for their other products yet. Notably, gmail and gcal have data that likely isn’t needed after some number of months." property=og:description><link href=https://alexsaveau.dev/blog/tips/privacy/automation/automate-deleting-old-google-emails-and-calendar-events rel=canonical><meta content=https://alexsaveau.dev/blog/tips/privacy/automation/automate-deleting-old-google-emails-and-calendar-events property=og:url><meta content="Alex Saveau" property=og:site_name><meta content=https://alexsaveau.dev/assets/resized/me2-800-min.jpg property=og:image><meta content=article property=og:type><meta content=2021-02-18T00:00:00+00:00 property=article:published_time><meta content=summary_large_image name=twitter:card><meta content=https://alexsaveau.dev/assets/resized/me2-800-min.jpg property=twitter:image><meta content="Automate deleting old Google emails and calendar events" property=twitter:title><meta content=@SUPERCILEX name=twitter:site><meta content=@SUPERCILEX name=twitter:creator><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"Alex Saveau"},"dateModified":"2021-02-19T01:31:03+00:00","datePublished":"2021-02-18T00:00:00+00:00","description":"Google introduced auto deletion for web, YouTube, and location activity back in 2019, but hasn’t come out with official solutions for their other products yet. Notably, gmail and gcal have data that likely isn’t needed after some number of months.","headline":"Automate deleting old Google emails and calendar events","image":"https://alexsaveau.dev/assets/resized/me2-800-min.jpg","mainEntityOfPage":{"@type":"WebPage","@id":"https://alexsaveau.dev/blog/tips/privacy/automation/automate-deleting-old-google-emails-and-calendar-events"},"url":"https://alexsaveau.dev/blog/tips/privacy/automation/automate-deleting-old-google-emails-and-calendar-events"}</script><script>window.addEventListener("DOMContentLoaded",()=>{for(let e of document.querySelectorAll(".loads")){var o=()=>{e.classList.remove("loads")};e.complete?o():(e.onload=o,e.onerror=o)}})</script><noscript><style>.loads{animation:none!important;background-color:unset!important}</style></noscript><link href=//fonts.gstatic.com/s/firacode/v17/uU9NCBsR6Z2vfE9aq3bh3dSD.woff2 rel=preload type=font/woff2 as=font crossorigin><style>@keyframes tooltip-appear{0%{opacity:0}to{opacity:1}}@keyframes pulse{0%,to{opacity:1}50%{opacity:.33}}:root{--progress-color:gray;--blockquote-color:#6a737d;--blockquote-boarder-color:#959da5;--code-background-color:rgba(0, 0, 0, 0.05);--hr-color:gray;--footer-color:white;--loading-pulse-color:#b0b0b0}@font-face{font-family:"Fira Code";font-style:normal;font-weight:475;font-display:swap;src:url(//fonts.gstatic.com/s/firacode/v17/uU9NCBsR6Z2vfE9aq3bh3dSD.woff2) format("woff2");unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+2000-206F,U+2074,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD}.article{overflow-wrap:break-word}.article .highlight{background-color:rgba(0,0,0,.04);border-radius:3px}.article h2,.article h3,.article h4{margin:1.5em 0-.5em}.article h2{font-size:1.875rem}.article h3{font-size:1.5rem}.article h4{font-size:1.25rem}.article p{font-size:1.313rem;margin:.95em 0 1.2em}.article code{font-family:"Fira Code",monospace;font-size:1rem;background-color:var(--code-background-color);border-radius:3px;padding:2px 4px}.article blockquote{border-left:4px solid var(--blockquote-boarder-color);padding-left:16px;margin-bottom:16px;margin-left:0;margin-right:0}.article blockquote :not(a){color:var(--blockquote-color)}.article div pre{padding:20px}.article div pre code,a{background-color:transparent}.article div pre code{padding:0}.article li ul,.article ul{font-size:1.313rem;padding-left:32px;margin-bottom:16px}.article li ul{padding-left:16px;margin-bottom:0}.header-link{visibility:hidden}h2:hover .header-link,h3:hover .header-link,h4:hover .header-link{visibility:visible}.octicon{display:inline-block;fill:currentColor;vertical-align:text-bottom}html{font-family:sans-serif;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}body{margin:0;font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Helvetica,Arial,sans-serif,"Apple Color Emoji","Segoe UI Emoji";line-height:1.5;color:#24292e;background-color:#fff;font-family:Atkinson Hyperlegible,sans-serif;font-size:1em}footer{display:block;display:flex;padding:5px;align-items:center;background-color:var(--footer-color)}a{color:#0366d6;text-decoration:none}a:active,a:hover{outline-width:0}h1{margin:.67em 0}small{font-size:90%}img{border-style:none}svg:not(:root){overflow:hidden}hr{box-sizing:content-box;height:0;margin:15px 0;overflow:hidden;background:0 0;border:0;border-bottom:1px solid #dfe2e5;border:1.5px solid var(--hr-color);border-radius:1.5px;background-color:var(--hr-color)}::-webkit-input-placeholder{color:inherit;opacity:.54}::-webkit-file-upload-button{-webkit-appearance:button;font:inherit}*{box-sizing:border-box}a:hover{text-decoration:underline}hr::after,hr::before{display:table;content:""}hr::after{clear:both}h1,h2,h3,h4,p,pre,ul{margin-top:0;margin-bottom:0}h1,h2,h3,h4{font-size:2rem;font-weight:600}h2,h3,h4{font-size:1.5rem}h3,h4{font-size:1.25rem}h4{font-size:1rem}p{margin-bottom:10px}blockquote{margin:0}ul{padding-left:0}code,pre{font-family:SFMono-Regular,Consolas,"Liberation Mono",Menlo,monospace;font-size:.75rem}:-ms-input-placeholder{color:#6a737d;opacity:1}::-ms-input-placeholder{color:#6a737d;opacity:1}:checked+.radio-label{position:relative;z-index:1;border-color:#0366d6}@media (min-width:768px){.col-md-5{width:41.66667%}.col-md-7{width:58.33333%}}@media (min-width:1012px){.col-lg-4{width:33.33333%}.col-lg-8{width:66.66667%}}@media (min-width:1280px){.col-xl-3{width:25%}.col-xl-9{width:75%}}.tooltipped{position:relative}.tooltipped::after,.tooltipped::before{position:absolute;display:none;pointer-events:none;opacity:0}.tooltipped::after{z-index:1000000;padding:.5em .75em;font:11px/1.5 -apple-system,BlinkMacSystemFont,"Segoe UI",Helvetica,Arial,sans-serif,"Apple Color Emoji","Segoe UI Emoji";-webkit-font-smoothing:subpixel-antialiased;color:#fff;text-align:center;text-decoration:none;text-shadow:none;text-transform:none;letter-spacing:normal;word-wrap:break-word;white-space:pre;content:attr(aria-label);background:#1b1f23;border-radius:6px}.tooltipped::before{z-index:1000001;width:0;height:0;color:#1b1f23;content:"";border:6px solid transparent}.tooltipped:active::after,.tooltipped:active::before,.tooltipped:focus::after,.tooltipped:focus::before,.tooltipped:hover::after,.tooltipped:hover::before{display:inline-block;text-decoration:none;animation-name:tooltip-appear;animation-duration:.1s;animation-fill-mode:forwards;animation-timing-function:ease-in;animation-delay:.4s}.tooltipped-se::after{top:100%;margin-top:6px}.tooltipped-se::before{top:auto;right:50%;bottom:-7px;margin-right:-6px;border-bottom-color:#1b1f23}.tooltipped-se::after{right:auto;left:50%;margin-left:-16px}.border-top{border-top:1px solid #e1e4e8!important}@media (min-width:768px){.border-md-right{border-right:1px solid #e1e4e8!important}.border-md-bottom{border-bottom:1px solid #e1e4e8!important}.border-md-top-0{border-top:0!important}}.circle{border-radius:50%!important}.border-gray-light{border-color:#eaecef!important}.bg-white{background-color:#fff!important}.bg-gray-light{background-color:#fafbfc!important}.text-gray{color:#586069!important}.flex-wrap{flex-wrap:wrap!important}.flex-items-start{align-items:flex-start!important}.flex-items-center{align-items:center!important}.flex-self-stretch{align-self:stretch!important}.v-align-middle{vertical-align:middle!important}.mr-2{margin-right:8px!important}.mx-auto{margin-right:auto!important;margin-left:auto!important}.px-4{padding-right:24px!important;padding-left:24px!important}.f4{font-size:1rem!important}@media (min-width:768px){.px-md-6{padding-right:40px!important;padding-left:40px!important}.f4{font-size:1rem!important}}.f5{font-size:.875rem!important}.f00-light{font-size:2.5rem!important;font-weight:300!important}@media (min-width:768px){.f00-light{font-size:3rem!important}}.f2-light{font-size:1.375rem!important;font-weight:300!important}.lh-condensed{line-height:1.25!important}.d-flex{display:flex!important}.d-none{display:none!important}@font-face{font-family:Inter;font-style:normal;font-weight:400;src:local("Inter"),local("Inter-Regular"),url(/fonts/Inter-Regular.woff) format("woff");font-display:swap}@font-face{font-family:Inter;font-style:normal;font-weight:500;src:local("Inter Medium"),local("Inter-Medium"),url(/fonts/Inter-Medium.woff) format("woff");font-display:swap}@font-face{font-family:Inter;font-style:normal;font-weight:600;src:local("Inter Bold"),local("Inter-Bold"),url(/fonts/Inter-Bold.woff) format("woff");font-display:swap}.mb-2{margin-bottom:8px!important}.mb-3{margin-bottom:16px!important}.mb-5{margin-bottom:32px!important}.mb-6{margin-bottom:40px!important}.py-6{padding-top:40px!important;padding-bottom:40px!important}.highlight{width:100%;overflow:auto;background:#fff}.highlight .k,.highlight .o{font-weight:700}.highlight .cm{color:#998;font-style:italic}.highlight .kc,.highlight .kd{font-weight:700}.highlight .na{color:teal}.highlight .nb{color:#0086b3}.highlight .mi{color:#099}.highlight .s1,.highlight .s2{color:#d14}@font-face{font-family:"Atkinson Hyperlegible";font-style:normal;font-weight:400;font-display:swap;src:url(//fonts.gstatic.com/s/atkinsonhyperlegible/v10/9Bt23C1KxNDXMspQ1lPyU89-1h6ONRlW45G04pIo.woff2) format("woff2");unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+2000-206F,U+2074,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD}footer small{width:100%}footer small:last-child{text-align:end}.min-height-full{min-height:100vh}.icon-color{fill:#24292e!important}.loads{animation-duration:2s;animation:2s cubic-bezier(.4,0,.6,1) infinite pulse;animation-timing-function:cubic-bezier(.4,0,.6,1);animation-iteration-count:infinite;animation-name:pulse;background-color:var(--loading-pulse-color)}@media (min-width:768px){.f2-light{font-size:1.5rem!important}.d-md-flex{display:flex!important}#masthead{position:fixed;width:min-content}.masthead-name-mobile{display:none}}@media (max-width:768px){.masthead-mini{padding-top:10px!important;padding-bottom:10px!important}.masthead-mini-container{display:flex;align-items:center}.masthead-profile{width:80px;height:80px;margin-bottom:0!important}.masthead-intro{padding-left:24px}.masthead-name{display:none}.masthead-bio{margin-bottom:0!important}.masthead-metadata{display:none}}@media (min-width:1942px){.masthead{max-width:400px}.content-container{width:100%}}@media (prefers-color-scheme:dark){:root{--progress-color:whitesmoke;--blockquote-color:#dadada;--blockquote-boarder-color:#dadada;--code-background-color:rgba(255,255,255,0.15);--hr-color:whitesmoke;--footer-color:black;--loading-pulse-color:#383838}.article p{color:#ededed}.highlight pre{background-color:#272822}.highlight .k{color:#66d9ef}.highlight .o{color:#f92672}.highlight .p{color:#f8f8f2}.highlight .cm{color:#b4aa77}.highlight .kc,.highlight .kd{color:#66d9ef}.highlight .na{color:#a6e22e}.highlight .nb{color:#f8f8f2}.highlight .nx{color:#a6e22e}.highlight .mi{color:#ae81ff}.highlight .s1,.highlight .s2{color:#e6db74}a{color:unset!important;text-decoration:underline}.bg-white{background-color:#4f565d!important}.bg-gray-light{background-color:#2f363d!important}.border-gray-light{border-color:transparent!important}.text-gray{color:#d0d8e1!important}.border-md-bottom{border:0!important}.masthead{background-color:#24292e!important}.scoped-text-defaults,.text-defaults,.text-defaults *{color:#fff!important}.icon-color{fill:#fff!important}}</style><body class=min-height-full id=top><div class="min-height-full bg-gray-light border-md-bottom d-md-flex"><div class="px-4 px-lg-7 py-6 bg-white border-gray-light border-md-right col-lg-4 col-md-5 col-xl-3 flex-self-stretch masthead masthead-mini px-md-6"><div class=masthead-mini-container id=masthead><a href=/ ><picture><source sizes=150px srcset="/assets/resized/me2-240-min.avif 240w, /assets/resized/me2-320-min.avif 320w, /assets/resized/me2-480-min.avif 480w, /assets/resized/me2-800-min.avif 800w, /assets/resized/me2-min.avif 1528w" type=image/avif><source sizes=150px srcset="/assets/resized/me2-240-min.jpg 240w, /assets/resized/me2-320-min.jpg 320w, /assets/resized/me2-480-min.jpg 480w, /assets/resized/me2-800-min.jpg 800w, /assets/resized/me2-min.jpg 1528w" type=image/jpeg><source sizes=150px srcset="/assets/resized/me2-240.jpg 240w, /assets/resized/me2-320.jpg 320w, /assets/resized/me2-480.jpg 480w, /assets/resized/me2-800.jpg 800w, /assets/me2.jpg 1528w"><img alt="Profile Picture" class="mb-3 circle loads masthead-profile" height=150 loading=lazy src=/assets/resized/me2-240.jpg width=150></picture></a><div class=masthead-intro><h1 class="text-defaults lh-condensed mb-2 masthead-name">Alex Saveau</h1><h2 class="text-defaults lh-condensed mb-2 masthead-name-mobile">Alex Saveau</h2><p class="mb-3 f4 masthead-bio text-gray" id=bio>Relentless efficiency</div><div class="f4 masthead-metadata"><div class="text-defaults d-flex flex-items-center mb-3"><svg height=20 viewBox="0 0 16 16" aria-label=GitHub class="icon-color mr-2 octicon v-align-middle octicon-mark-github" role=img version=1.1 width=20><path d="M8 0c4.42 0 8 3.58 8 8a8.013 8.013 0 0 1-5.45 7.59c-.4.08-.55-.17-.55-.38 0-.27.01-1.13.01-2.2 0-.75-.25-1.23-.54-1.48 1.78-.2 3.65-.88 3.65-3.95 0-.88-.31-1.59-.82-2.15.08-.2.36-1.02-.08-2.12 0 0-.67-.22-2.2.82-.64-.18-1.32-.27-2-.27-.68 0-1.36.09-2 .27-1.53-1.03-2.2-.82-2.2-.82-.44 1.1-.16 1.92-.08 2.12-.51.56-.82 1.28-.82 2.15 0 3.06 1.86 3.75 3.64 3.95-.23.2-.44.55-.51 1.07-.46.21-1.61.55-2.33-.66-.15-.24-.6-.83-1.23-.82-.67.01-.27.38.01.53.34.19.73.9.82 1.13.16.45.68 1.31 2.69.94 0 .67.01 1.3.01 1.49 0 .21-.15.45-.55.38A7.995 7.995 0 0 1 0 8c0-4.42 3.58-8 8-8Z"></path></svg> <a href=//github.com/SUPERCILEX>@SUPERCILEX</a></div><div class="text-defaults d-flex flex-items-center mb-3"><svg height=20 viewBox="0 0 16 16" aria-label=email class="icon-color mr-2 octicon v-align-middle octicon-mail" role=img version=1.1 width=20><path d="M1.75 2h12.5c.966 0 1.75.784 1.75 1.75v8.5A1.75 1.75 0 0 1 14.25 14H1.75A1.75 1.75 0 0 1 0 12.25v-8.5C0 2.784.784 2 1.75 2ZM1.5 12.251c0 .138.112.25.25.25h12.5a.25.25 0 0 0 .25-.25V5.809L8.38 9.397a.75.75 0 0 1-.76 0L1.5 5.809v6.442Zm13-8.181v-.32a.25.25 0 0 0-.25-.25H1.75a.25.25 0 0 0-.25.25v.32L8 7.88Z"></path></svg> <a href=mailto:saveau.alexandre@gmail.com>saveau.alexandre@gmail.com</a></div><div class="flex-items-start d-flex flex-wrap"><div class=mb-3><a href=//stackoverflow.com/u/4548500 class="tooltipped tooltipped-se" aria-label="Stack Overflow: 4548500"><svg height=24 viewBox="0 0 120 120" fill=#959da5 xmlns=http://www.w3.org/2000/svg><path d="M84.4 93.8V70.6h7.7v30.9H22.6V70.6h7.7v23.2z" class=st0 /><path d="M38.8 68.4l37.8 7.9 1.6-7.6-37.8-7.9-1.6 7.6zm5-18l35 16.3 3.2-7-35-16.4-3.2 7.1zm9.7-17.2l29.7 24.7 4.9-5.9-29.7-24.7-4.9 5.9zm19.2-18.3l-6.2 4.6 23 31 6.2-4.6-23-31zM38 86h38.6v-7.7H38V86z" class=st1 /></svg><span class=d-none>Stack Overflow</span></a></div></div></div></div></div><div class="px-4 px-lg-7 py-6 border-md-top-0 border-top col-lg-8 col-md-7 col-xl-9 content-container" id=article><div class=mx-auto style=max-width:900px><div class="f4 mb-6"><div class="f4 scoped-text-defaults"><p class=f5><a href=/blog class="text-defaults d-flex flex-items-center"><svg height=16 viewBox="0 0 16 16" aria-label=include.parent class="icon-color mr-2 octicon v-align-middle octicon-chevron-left" role=img version=1.1 width=16><path d="M9.78 12.78a.75.75 0 0 1-1.06 0L4.47 8.53a.75.75 0 0 1 0-1.06l4.25-4.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042L6.06 8l3.72 3.72a.75.75 0 0 1 0 1.06Z"></path></svg>Blog</a><h1 class="text-defaults lh-condensed f00-light" style=font-weight:600!important>Automate deleting old Google emails and calendar events</h1><h2 class="lh-condensed f2-light text-gray" style=font-weight:400!important>Take control of your old data</h2><p class="mb-5 text-gray">Published Feb 18, 2021 • Last updated Feb 19, 2021 • 3 min read<div class=article><p>Google <a href=//blog.google/technology/safety-security/automatically-delete-data/ >introduced</a> auto deletion for web, YouTube, and location activity back in 2019, but hasn’t come out with official solutions for their other products yet. Notably, gmail and gcal have data that likely isn’t needed after some number of months.<p>To automate deleting old data, <a href=//developers.google.com/apps-script>Google Apps Script</a> is the handiest tool available. Off we go:<ul id=markdown-toc><li><a href=#creating-a-script id=markdown-toc-creating-a-script>Creating a script</a><li><a href=#scheduling-scripts-as-cron-jobs id=markdown-toc-scheduling-scripts-as-cron-jobs>Scheduling scripts as CRON jobs</a><li><a href=#using-scripts-across-multiple-google-accounts id=markdown-toc-using-scripts-across-multiple-google-accounts>Using scripts across multiple Google accounts</a><li><a href=#thorn-google-accounts-in-the-advanced-protection-program id=markdown-toc-thorn-google-accounts-in-the-advanced-protection-program>Thorn: Google accounts in the Advanced Protection Program</a><li><a href=#appendix id=markdown-toc-appendix>Appendix</a><ul><li><a href=#email-deletion id=markdown-toc-email-deletion>Email deletion</a><ul><li><a href=#script id=markdown-toc-script>Script</a></ul><li><a href=#calendar-event-deletion id=markdown-toc-calendar-event-deletion>Calendar event deletion</a><ul><li><a href=#script-1 id=markdown-toc-script-1>Script</a></ul></ul></ul><h2 id=creating-a-script>Creating a script <a href=#creating-a-script class=header-link>#</a></h2><p>Visit <a href=//script.new>script.new</a> and write your own code, or paste in the solutions I’ve been using from the <a href=#appendix>appendix</a>. Hit save, and the editor will automatically pick the first function it sees to run by default.<p>You can then click on Run to execute the script manually, giving it permissions to access your account.<blockquote><p>Note: the first time you run a script operating on lots of data, it will probably fail several times with various quota errors. You can either continue running it manually until the script reaches a steady state (having processed all your data), or move on to scheduling it and let things eventually sort themselves out.</blockquote><h2 id=scheduling-scripts-as-cron-jobs>Scheduling scripts as CRON jobs <a href=#scheduling-scripts-as-cron-jobs class=header-link>#</a></h2><p>Once you’ve executed the script at least once to give it the correct permissions, you can use the Triggers page found in the left sidebar to schedule your script for periodic execution. The defaults when you add a trigger are good enough, but I tend to downgrade the schedule from every hour to once a day as an hourly job seems a tad wasteful.<h2 id=using-scripts-across-multiple-google-accounts>Using scripts across multiple Google accounts <a href=#using-scripts-across-multiple-google-accounts class=header-link>#</a></h2><p>You can share a script like a Google Doc, but you’ll have to run it once and create a Trigger for each account. The main benefit of sharing the script is that modifications only need to be performed once instead of being copied to each account.<h2 id=thorn-google-accounts-in-the-advanced-protection-program>Thorn: Google accounts in the Advanced Protection Program <a href=#thorn-google-accounts-in-the-advanced-protection-program class=header-link>#</a></h2><p>Sadly, if your Google account is enrolled in the <a href=//landing.google.com/advancedprotection/ >Advanced Protection Program</a>, there is no way that I’m aware of to run unapproved Apps Scripts. When you try to accept the permissions on the first run, the request will be denied. This is apparently <a href="//support.google.com/accounts/answer/7539956?hl=en#zippy=%2Ccan-i-use-non-google-apps-services-or-apps-script-with-advanced-protection">intentional</a> which is a bummer.<hr><h2 id=appendix>Appendix <a href=#appendix class=header-link>#</a></h2><p>These are the scripts I’ve been using to manage my own old data.<blockquote><p>Note: when I say “delete” below, I really mean “move to trash.” The scripts don’t empty the trash, allowing for the standard 30-day grace period to elapse.</blockquote><h3 id=email-deletion>Email deletion <a href=#email-deletion class=header-link>#</a></h3><p>This script deletes emails that don’t have the <code class="highlighter-rouge language-plaintext">indef</code> label <em>and</em> are 18 months old (or older). It also deletes any unread emails that have been archived.<p>Reference docs are available <a href=//developers.google.com/apps-script/reference/gmail>here</a> and you can read about creating labels in Gmail <a href=//support.google.com/mail/answer/118708>here</a>.<p>Expected workflow:<ul><li>Manually label all critical emails with the <code class="highlighter-rouge language-plaintext">indef</code> label. Any other email is transient and will eventually be deleted.<li>Any email you swipe away (archive) without opening is unneeded and gets deleted immediately. This mainly enables Inbox Zero without having to manually open emails you don’t care about to mark them as read and then archive them.</ul><h4 id=script>Script <a href=#script class=header-link>#</a></h4><p><div class="highlighter-rouge language-javascript"><div class=highlight><pre class=highlight><code><span class=cm>/** Deletes 18 month+ old emails and unread archived emails. */</span>
<span class=kd>function</span> <span class=nx>processMail</span><span class=p>()</span> <span class=p>{</span>
  <span class=nx>deleteEmailMatching</span><span class=p>(</span><span class=dl>'</span><span class=s1>label:unread -label:inbox</span><span class=dl>'</span><span class=p>);</span>
  <span class=nx>deleteEmailMatching</span><span class=p>(</span><span class=dl>'</span><span class=s1>older_than:18m -label:indef</span><span class=dl>'</span><span class=p>);</span>
<span class=p>}</span>

<span class=kd>function</span> <span class=nx>deleteEmailMatching</span><span class=p>(</span><span class=nx>query</span><span class=p>)</span> <span class=p>{</span>
  <span class=kd>let</span> <span class=nx>threads</span> <span class=o>=</span> <span class=p>[];</span>
  <span class=k>while</span> <span class=p>(</span><span class=kc>true</span><span class=p>)</span> <span class=p>{</span>
    <span class=nx>threads</span> <span class=o>=</span> <span class=nx>GmailApp</span><span class=p>.</span><span class=nx>search</span><span class=p>(</span><span class=nx>query</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>100</span><span class=p>);</span>
    <span class=k>if</span> <span class=p>(</span><span class=nx>threads</span><span class=p>.</span><span class=nx>length</span> <span class=o>></span> <span class=mi>0</span><span class=p>)</span> <span class=p>{</span>
      <span class=nx>trash</span><span class=p>(</span><span class=nx>threads</span><span class=p>);</span>
    <span class=p>}</span> <span class=k>else</span> <span class=p>{</span>
      <span class=k>break</span><span class=p>;</span>
    <span class=p>}</span>
  <span class=p>}</span>
<span class=p>}</span>

<span class=kd>function</span> <span class=nx>trash</span><span class=p>(</span><span class=nx>threads</span><span class=p>)</span> <span class=p>{</span>
  <span class=nx>threads</span><span class=p>.</span><span class=nx>forEach</span><span class=p>(</span><span class=nx>thread</span> <span class=o>=></span> <span class=p>{</span>
    <span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=s2>`Deleting email '</span><span class=p>${</span><span class=nx>thread</span><span class=p>.</span><span class=nx>getFirstMessageSubject</span><span class=p>()}</span><span class=s2>': </span><span class=p>${</span><span class=nx>thread</span><span class=p>.</span><span class=nx>getPermalink</span><span class=p>()}</span><span class=s2>`</span><span class=p>);</span>
  <span class=p>});</span>
  <span class=nx>GmailApp</span><span class=p>.</span><span class=nx>moveThreadsToTrash</span><span class=p>(</span><span class=nx>threads</span><span class=p>);</span>
<span class=p>}</span>
</code></pre></div></div><h3 id=calendar-event-deletion>Calendar event deletion <a href=#calendar-event-deletion class=header-link>#</a></h3><p>This script deletes calendar events that are 18 months old (or older). It includes an <code class="highlighter-rouge language-plaintext">OTHER_EMAILS</code> field that allows a single account to handle auto-deleting events for any other account.<p>Reference docs are available <a href=//developers.google.com/apps-script/reference/calendar>here</a>.<p>Expected workflow:<ul><li>Give the <code class="highlighter-rouge language-plaintext">Make changes to events</code> permission to the account running the script for any calendar where you want auto-deletion running. Then add the calendar’s email to the <code class="highlighter-rouge language-plaintext">OTHER_EMAILS</code> array in the script. If it’s not your primary calendar, you can find its ID/email by going to the calendar’s settings and looking at the first field under the <code class="highlighter-rouge language-plaintext">Integrate calendar</code> section.</ul><h4 id=script-1>Script <a href=#script-1 class=header-link>#</a></h4><p><div class="highlighter-rouge language-javascript"><div class=highlight><pre class=highlight><code><span class=kd>const</span> <span class=nx>OTHER_EMAILS</span> <span class=o>=</span> <span class=p>[</span>
  <span class=dl>'</span><span class=s1>foo@example.com</span><span class=dl>'</span><span class=p>,</span>
  <span class=dl>'</span><span class=s1>...</span><span class=dl>'</span><span class=p>,</span>
<span class=p>]</span>

<span class=cm>/** Deletes calender events that took place 18 months ago or earlier. */</span>
<span class=kd>function</span> <span class=nx>processCalendars</span><span class=p>()</span> <span class=p>{</span>
  <span class=k>for</span> <span class=p>(</span><span class=kd>let</span> <span class=nx>calendar</span> <span class=k>of</span> <span class=nx>CalendarApp</span><span class=p>.</span><span class=nx>getAllCalendars</span><span class=p>())</span> <span class=p>{</span>
    <span class=k>if</span> <span class=p>(</span><span class=nx>calendar</span><span class=p>.</span><span class=nx>isOwnedByMe</span><span class=p>()</span> <span class=o>||</span> <span class=nx>OTHER_EMAILS</span><span class=p>.</span><span class=nx>includes</span><span class=p>(</span><span class=nx>calendar</span><span class=p>.</span><span class=nx>getId</span><span class=p>()))</span> <span class=p>{</span>
      <span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=s2>`Deleting old events in calendar: </span><span class=p>${</span><span class=nx>calendar</span><span class=p>.</span><span class=nx>getName</span><span class=p>()}</span><span class=s2> (</span><span class=p>${</span><span class=nx>calendar</span><span class=p>.</span><span class=nx>getId</span><span class=p>()}</span><span class=s2>)`</span><span class=p>);</span>
      <span class=nx>deleteOldEvents</span><span class=p>(</span><span class=nx>calendar</span><span class=p>);</span>
    <span class=p>}</span>
  <span class=p>}</span>
<span class=p>}</span>

<span class=kd>function</span> <span class=nx>deleteOldEvents</span><span class=p>(</span><span class=nx>calendar</span><span class=p>)</span> <span class=p>{</span>
  <span class=kd>const</span> <span class=nx>epoch</span> <span class=o>=</span> <span class=k>new</span> <span class=nb>Date</span><span class=p>(</span><span class=mi>0</span><span class=p>);</span>
  <span class=kd>const</span> <span class=nx>eitghteenMonthsAgo</span> <span class=o>=</span> <span class=k>new</span> <span class=nb>Date</span><span class=p>(</span>
      <span class=k>new</span> <span class=nb>Date</span><span class=p>().</span><span class=nx>getTime</span><span class=p>()</span> <span class=o>-</span> <span class=p>(</span><span class=mi>1000</span> <span class=o>*</span> <span class=mi>60</span> <span class=o>*</span> <span class=mi>60</span> <span class=o>*</span> <span class=mi>24</span> <span class=o>*</span> <span class=mi>30</span> <span class=o>*</span> <span class=mi>18</span><span class=p>));</span>

  <span class=k>while</span> <span class=p>(</span><span class=kc>true</span><span class=p>)</span> <span class=p>{</span>
    <span class=kd>const</span> <span class=nx>oldEvents</span> <span class=o>=</span>
        <span class=nx>calendar</span><span class=p>.</span><span class=nx>getEvents</span><span class=p>(</span><span class=nx>epoch</span><span class=p>,</span> <span class=nx>eitghteenMonthsAgo</span><span class=p>,</span> <span class=p>{</span><span class=na>max</span><span class=p>:</span> <span class=mi>100</span><span class=p>});</span>
    <span class=k>if</span> <span class=p>(</span><span class=nx>oldEvents</span><span class=p>.</span><span class=nx>length</span> <span class=o>==</span> <span class=mi>0</span><span class=p>)</span> <span class=p>{</span>
      <span class=k>break</span><span class=p>;</span>
    <span class=p>}</span>

    <span class=k>for</span> <span class=p>(</span><span class=kd>let</span> <span class=nx>event</span> <span class=k>of</span> <span class=nx>oldEvents</span><span class=p>)</span> <span class=p>{</span>
      <span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=s2>`Deleting event '</span><span class=p>${</span><span class=nx>event</span><span class=p>.</span><span class=nx>getTitle</span><span class=p>()}</span><span class=s2>' `</span> <span class=o>+</span>
          <span class=s2>`that took place between </span><span class=p>${</span><span class=nx>event</span><span class=p>.</span><span class=nx>getStartTime</span><span class=p>()}</span><span class=s2> and </span><span class=p>${</span><span class=nx>event</span><span class=p>.</span><span class=nx>getEndTime</span><span class=p>()}</span><span class=s2>`</span><span class=p>);</span>
      <span class=nx>event</span><span class=p>.</span><span class=nx>deleteEvent</span><span class=p>();</span>
    <span class=p>}</span>
  <span class=p>}</span>
<span class=p>}</span>
</code></pre></div></div></div></div></div></div></div></div><footer class=text-defaults><small>Copyright © 2018-2026 Alex Saveau</small> <small><a href=//github.com/SUPERCILEX/personal-website>Source</a> | <a href=//twitter.com/SUPERCILEX>Twitter</a> | <a href=#top>Back to top</a></small></footer>