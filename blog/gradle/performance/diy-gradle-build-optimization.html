<!doctype html><html class=min-height-full lang=en><meta charset=utf-8><meta content="width=device-width,initial-scale=1,shrink-to-fit=no" name=viewport><meta content="light dark" name=color-scheme><link href=/favicon.ico rel=icon type=image/x-icon><link href=//fonts.gstatic.com/s/atkinsonhyperlegible/v10/9Bt23C1KxNDXMspQ1lPyU89-1h6ONRlW45G04pIo.woff2 rel=preload type=font/woff2 as=font crossorigin><link href=/feed.xml rel=alternate type=application/atom+xml title="Alex Saveau"><title>DIY Gradle build optimization | Alex Saveau</title><meta content="Jekyll v4.3.2" name=generator><meta content="DIY Gradle build optimization" property=og:title><meta content="Alex Saveau" name=author><meta content=en_US property=og:locale><meta content="If you’re anything like me a few months ago, you’ve hit a breaking point. You’re feeling something akin to desperation and you don’t know what to do. You’ve already tried all the classic tricks like fiddling with JVM args and Gradle properties, but to no avail." name=description><meta content="If you’re anything like me a few months ago, you’ve hit a breaking point. You’re feeling something akin to desperation and you don’t know what to do. You’ve already tried all the classic tricks like fiddling with JVM args and Gradle properties, but to no avail." property=og:description><link href=https://alexsaveau.dev/blog/gradle/performance/diy-gradle-build-optimization rel=canonical><meta content=https://alexsaveau.dev/blog/gradle/performance/diy-gradle-build-optimization property=og:url><meta content="Alex Saveau" property=og:site_name><meta content=https://alexsaveau.dev/assets/resized/gradle/abstract-build-800-min.jpg property=og:image><meta content=article property=og:type><meta content=2018-09-05T00:00:00+00:00 property=article:published_time><meta content=summary_large_image name=twitter:card><meta content=https://alexsaveau.dev/assets/resized/gradle/abstract-build-800-min.jpg property=twitter:image><meta content="DIY Gradle build optimization" property=twitter:title><meta content=@SUPERCILEX name=twitter:site><meta content=@SUPERCILEX name=twitter:creator><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"Alex Saveau"},"dateModified":"2020-06-17T22:29:04+00:00","datePublished":"2018-09-05T00:00:00+00:00","description":"If you’re anything like me a few months ago, you’ve hit a breaking point. You’re feeling something akin to desperation and you don’t know what to do. You’ve already tried all the classic tricks like fiddling with JVM args and Gradle properties, but to no avail.","headline":"DIY Gradle build optimization","image":"https://alexsaveau.dev/assets/resized/gradle/abstract-build-800-min.jpg","mainEntityOfPage":{"@type":"WebPage","@id":"https://alexsaveau.dev/blog/gradle/performance/diy-gradle-build-optimization"},"url":"https://alexsaveau.dev/blog/gradle/performance/diy-gradle-build-optimization"}</script><script>window.addEventListener("DOMContentLoaded",()=>{for(let e of document.querySelectorAll(".loads")){var o=()=>{e.classList.remove("loads")};e.complete?o():(e.onload=o,e.onerror=o)}})</script><noscript><style>.loads{animation:none!important;background-color:unset!important}</style></noscript><link href=//fonts.gstatic.com/s/firacode/v17/uU9NCBsR6Z2vfE9aq3bh3dSD.woff2 rel=preload type=font/woff2 as=font crossorigin><style>@keyframes tooltip-appear{0%{opacity:0}to{opacity:1}}@keyframes pulse{0%,to{opacity:1}50%{opacity:.33}}:root{--progress-color:gray;--blockquote-color:#6a737d;--blockquote-boarder-color:#959da5;--code-background-color:rgba(0, 0, 0, 0.05);--hr-color:gray;--footer-color:white;--loading-pulse-color:#b0b0b0}@font-face{font-family:"Fira Code";font-style:normal;font-weight:475;font-display:swap;src:url(//fonts.gstatic.com/s/firacode/v17/uU9NCBsR6Z2vfE9aq3bh3dSD.woff2) format("woff2");unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+2000-206F,U+2074,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD}.article{overflow-wrap:break-word}.article .highlight{background-color:rgba(0,0,0,.04);border-radius:3px}.article .caption{font-size:1rem;margin:-1.5em 0 0}.article .gist-caption{font-size:1rem;margin:-.5em 0 0}.article h2,.article h3{margin:1.5em 0-.5em}.article h2{font-size:1.875rem}.article h3{font-size:1.5rem}.article h3 code,.article strong{font-size:1.25rem}.article p{font-size:1.313rem;margin:.95em 0 1.2em}.article p.caption{text-align:center}.article img.article-image{width:100%;height:auto}.article code{font-family:"Fira Code",monospace;font-size:1rem;background-color:var(--code-background-color);border-radius:3px;padding:2px 4px}.article blockquote{border-left:4px solid var(--blockquote-boarder-color);padding-left:16px;margin-bottom:16px;margin-left:0;margin-right:0}.article blockquote :not(a){color:var(--blockquote-color)}.article div pre{padding:20px}.article div pre code,a{background-color:transparent}.article div pre code{padding:0}.article ol,.article ul{font-size:1.313rem;padding-left:32px;margin-bottom:16px}.header-link{visibility:hidden}h2:hover .header-link,h3:hover .header-link{visibility:visible}@media (prefers-color-scheme:dark){:root{--progress-color:whitesmoke;--blockquote-color:#dadada;--blockquote-boarder-color:#dadada;--code-background-color:rgba(255,255,255,0.15)}.article .caption,.article .gist-caption{color:#dadada}.article p{color:#ededed}.article img:not([src*=".svg"]){filter:brightness(.8) contrast(1.1)}}.octicon{display:inline-block;fill:currentColor;vertical-align:text-bottom}html{font-family:sans-serif;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}body{margin:0;font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Helvetica,Arial,sans-serif,"Apple Color Emoji","Segoe UI Emoji";line-height:1.5;color:#24292e;background-color:#fff;font-family:Atkinson Hyperlegible,sans-serif;font-size:1em}footer{display:block;display:flex;padding:5px;align-items:center;background-color:var(--footer-color)}a{color:#0366d6;text-decoration:none}a:active,a:hover{outline-width:0}strong{font-weight:600}h1{margin:.67em 0}small{font-size:90%}img{border-style:none}svg:not(:root){overflow:hidden}hr{box-sizing:content-box;height:0;margin:15px 0;overflow:hidden;background:0 0;border:0;border-bottom:1px solid #dfe2e5;border:1.5px solid var(--hr-color);border-radius:1.5px;background-color:var(--hr-color)}::-webkit-input-placeholder{color:inherit;opacity:.54}::-webkit-file-upload-button{-webkit-appearance:button;font:inherit}*{box-sizing:border-box}.selectively-underline:hover span,a:hover{text-decoration:underline}hr::after,hr::before{display:table;content:""}hr::after{clear:both}h1,h2,h3,ol,p,pre,ul{margin-top:0;margin-bottom:0}h1,h2,h3{font-size:2rem;font-weight:600}h2,h3{font-size:1.5rem}h3{font-size:1.25rem}p{margin-bottom:10px}blockquote{margin:0}ol,ul{padding-left:0}code,pre{font-family:SFMono-Regular,Consolas,"Liberation Mono",Menlo,monospace;font-size:.75rem}:-ms-input-placeholder{color:#6a737d;opacity:1}::-ms-input-placeholder{color:#6a737d;opacity:1}:checked+.radio-label{position:relative;z-index:1;border-color:#0366d6}@media (min-width:768px){.col-md-5{width:41.66667%}.col-md-7{width:58.33333%}}@media (min-width:1012px){.col-lg-4{width:33.33333%}.col-lg-8{width:66.66667%}}@media (min-width:1280px){.col-xl-3{width:25%}.col-xl-9{width:75%}}.tooltipped{position:relative}.tooltipped::after,.tooltipped::before{position:absolute;display:none;pointer-events:none;opacity:0}.tooltipped::after{z-index:1000000;padding:.5em .75em;font:11px/1.5 -apple-system,BlinkMacSystemFont,"Segoe UI",Helvetica,Arial,sans-serif,"Apple Color Emoji","Segoe UI Emoji";-webkit-font-smoothing:subpixel-antialiased;color:#fff;text-align:center;text-decoration:none;text-shadow:none;text-transform:none;letter-spacing:normal;word-wrap:break-word;white-space:pre;content:attr(aria-label);background:#1b1f23;border-radius:6px}.tooltipped::before{z-index:1000001;width:0;height:0;color:#1b1f23;content:"";border:6px solid transparent}.tooltipped:active::after,.tooltipped:active::before,.tooltipped:focus::after,.tooltipped:focus::before,.tooltipped:hover::after,.tooltipped:hover::before{display:inline-block;text-decoration:none;animation-name:tooltip-appear;animation-duration:.1s;animation-fill-mode:forwards;animation-timing-function:ease-in;animation-delay:.4s}.tooltipped-se::after{top:100%;margin-top:6px}.tooltipped-se::before{top:auto;right:50%;bottom:-7px;margin-right:-6px;border-bottom-color:#1b1f23}.tooltipped-se::after{right:auto;left:50%;margin-left:-16px}.border{border:1px solid #e1e4e8!important}.border-top{border-top:1px solid #e1e4e8!important}.rounded-1{border-radius:4px!important}@media (min-width:768px){.border-md-right{border-right:1px solid #e1e4e8!important}.border-md-bottom{border-bottom:1px solid #e1e4e8!important}.border-md-top-0{border-top:0!important}}.circle{border-radius:50%!important}.border-gray-light{border-color:#eaecef!important}.bg-white{background-color:#fff!important}.bg-gray-light{background-color:#fafbfc!important}.link-gray,.text-gray{color:#586069!important}.link-gray:hover{color:#0366d6!important}.flex-column{flex-direction:column!important}.flex-wrap{flex-wrap:wrap!important}.flex-justify-between{justify-content:space-between!important}.flex-items-start{align-items:flex-start!important}.flex-items-center{align-items:center!important}.flex-self-stretch{align-self:stretch!important}.v-align-middle{vertical-align:middle!important}.height-full{height:100%!important}.ml-0{margin-left:0!important}.mr-1{margin-right:4px!important}.mr-2{margin-right:8px!important}.mr-4{margin-right:24px!important}.mx-auto{margin-right:auto!important;margin-left:auto!important}.px-4{padding-right:24px!important;padding-left:24px!important}.f4{font-size:1rem!important}@media (min-width:768px){.px-md-6{padding-right:40px!important;padding-left:40px!important}.f4{font-size:1rem!important}}.f5{font-size:.875rem!important}.f00-light{font-size:2.5rem!important;font-weight:300!important}@media (min-width:768px){.f00-light{font-size:3rem!important}}.f2-light{font-size:1.375rem!important;font-weight:300!important}.lh-condensed{line-height:1.25!important}.text-left{text-align:left!important}.ws-normal{white-space:normal!important}.d-flex{display:flex!important}.d-inline-block{display:inline-block!important}.d-none{display:none!important}@media (min-width:768px){.f2-light{font-size:1.5rem!important}.d-md-flex{display:flex!important}}@font-face{font-family:Inter;font-style:normal;font-weight:400;src:local("Inter"),local("Inter-Regular"),url(/fonts/Inter-Regular.woff) format("woff");font-display:swap}@font-face{font-family:Inter;font-style:normal;font-weight:500;src:local("Inter Medium"),local("Inter-Medium"),url(/fonts/Inter-Medium.woff) format("woff");font-display:swap}@font-face{font-family:Inter;font-style:normal;font-weight:600;src:local("Inter Bold"),local("Inter-Bold"),url(/fonts/Inter-Bold.woff) format("woff");font-display:swap}.mb-1{margin-bottom:4px!important}.mb-2{margin-bottom:8px!important}.mb-3{margin-bottom:16px!important}.mb-5{margin-bottom:32px!important}.mb-6{margin-bottom:40px!important}.p-3{padding:16px!important}.py-6{padding-top:40px!important;padding-bottom:40px!important}.highlight{width:100%;overflow:auto;background:#fff}.highlight .nb{color:#0086b3}.highlight .nt{color:navy}.highlight .nv{color:teal}.highlight .s2{color:#d14}@font-face{font-family:"Atkinson Hyperlegible";font-style:normal;font-weight:400;font-display:swap;src:url(//fonts.gstatic.com/s/atkinsonhyperlegible/v10/9Bt23C1KxNDXMspQ1lPyU89-1h6ONRlW45G04pIo.woff2) format("woff2");unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+2000-206F,U+2074,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD}footer small{width:100%}footer small:last-child{text-align:end}.selectively-underline:hover{text-decoration:none}.repo-language-color{filter:brightness(125%)!important;border-radius:50%;display:inline-block;height:12px;position:relative;top:2px;width:12px}.emoji{width:18px;height:auto;vertical-align:middle}.min-height-full{min-height:100vh}.icon-color{fill:#24292e!important}.loads{animation-duration:2s;animation:2s cubic-bezier(.4,0,.6,1) infinite pulse;animation-timing-function:cubic-bezier(.4,0,.6,1);animation-iteration-count:infinite;animation-name:pulse;background-color:var(--loading-pulse-color)}@media (min-width:768px){#masthead{position:fixed;width:min-content}.masthead-name-mobile{display:none}}@media (max-width:768px){.masthead-mini{padding-top:10px!important;padding-bottom:10px!important}.masthead-mini-container{display:flex;align-items:center}.masthead-profile{width:80px;height:80px;margin-bottom:0!important}.masthead-intro{padding-left:24px}.masthead-name{display:none}.masthead-bio{margin-bottom:0!important}.masthead-metadata{display:none}}@media (min-width:1942px){.masthead{max-width:400px}.content-container{width:100%}}@media (prefers-color-scheme:dark){.highlight pre{background-color:#272822}.highlight .nb{color:#f8f8f2}.highlight .nt{color:#f92672}.highlight .nv{color:#f8f8f2}.highlight .s2{color:#e6db74}:root{--hr-color:whitesmoke;--footer-color:black;--loading-pulse-color:#383838}a{color:unset!important}.selectively-underline{text-decoration:none}.selectively-underline span,a{text-decoration:underline}.bg-white{background-color:#4f565d!important}.bg-gray-light{background-color:#2f363d!important}.border-gray-light{border-color:transparent!important}.link-gray,.link-gray:hover,.text-gray{color:#d0d8e1!important}.border,.border-md-bottom{border:0!important}.masthead{background-color:#24292e!important}.scoped-text-defaults,.text-defaults,.text-defaults *{color:#fff!important}.icon-color{fill:#fff!important}}</style><body class=min-height-full id=top><div class="min-height-full bg-gray-light border-md-bottom d-md-flex"><div class="bg-white border-gray-light border-md-right col-lg-4 col-md-5 col-xl-3 flex-self-stretch masthead masthead-mini px-4 px-lg-7 px-md-6 py-6"><div class=masthead-mini-container id=masthead><a href=/ ><picture><source sizes=150px srcset="/assets/resized/me2-240-min.avif 240w, /assets/resized/me2-320-min.avif 320w, /assets/resized/me2-480-min.avif 480w, /assets/resized/me2-800-min.avif 800w, /assets/resized/me2-min.avif 1528w" type=image/avif><source sizes=150px srcset="/assets/resized/me2-240-min.webp 240w, /assets/resized/me2-320-min.webp 320w, /assets/resized/me2-480-min.webp 480w, /assets/resized/me2-800-min.webp 800w, /assets/resized/me2-min.webp 1528w" type=image/webp><source sizes=150px srcset="/assets/resized/me2-240-min.jpg 240w, /assets/resized/me2-320-min.jpg 320w, /assets/resized/me2-480-min.jpg 480w, /assets/resized/me2-800-min.jpg 800w, /assets/resized/me2-min.jpg 1528w" type=image/jpeg><source sizes=150px srcset="/assets/resized/me2-240.jpg 240w, /assets/resized/me2-320.jpg 320w, /assets/resized/me2-480.jpg 480w, /assets/resized/me2-800.jpg 800w, /assets/me2.jpg 1528w"><img alt="Profile Picture" class="loads circle masthead-profile mb-3" height=150 src=/assets/resized/me2-240.jpg width=150 loading=lazy></picture></a><div class=masthead-intro><h1 class="text-defaults lh-condensed mb-2 masthead-name">Alex Saveau</h1><h2 class="text-defaults lh-condensed mb-2 masthead-name-mobile">Alex Saveau</h2><p class="text-gray f4 masthead-bio mb-3" id=bio>Relentless efficiency</div><div class="f4 masthead-metadata"><div class="text-defaults d-flex flex-items-center mb-3"><svg height=20 viewbox="0 0 16 16" class="icon-color octicon v-align-middle mr-2 octicon-mark-github" version=1.1 width=20 aria-label=GitHub role=img><path d="M8 0c4.42 0 8 3.58 8 8a8.013 8.013 0 0 1-5.45 7.59c-.4.08-.55-.17-.55-.38 0-.27.01-1.13.01-2.2 0-.75-.25-1.23-.54-1.48 1.78-.2 3.65-.88 3.65-3.95 0-.88-.31-1.59-.82-2.15.08-.2.36-1.02-.08-2.12 0 0-.67-.22-2.2.82-.64-.18-1.32-.27-2-.27-.68 0-1.36.09-2 .27-1.53-1.03-2.2-.82-2.2-.82-.44 1.1-.16 1.92-.08 2.12-.51.56-.82 1.28-.82 2.15 0 3.06 1.86 3.75 3.64 3.95-.23.2-.44.55-.51 1.07-.46.21-1.61.55-2.33-.66-.15-.24-.6-.83-1.23-.82-.67.01-.27.38.01.53.34.19.73.9.82 1.13.16.45.68 1.31 2.69.94 0 .67.01 1.3.01 1.49 0 .21-.15.45-.55.38A7.995 7.995 0 0 1 0 8c0-4.42 3.58-8 8-8Z"></path></svg> <a href=//github.com/SUPERCILEX>@SUPERCILEX</a></div><div class="text-defaults d-flex flex-items-center mb-3"><svg height=20 viewbox="0 0 16 16" class="icon-color octicon v-align-middle mr-2 octicon-mail" version=1.1 width=20 aria-label=email role=img><path d="M1.75 2h12.5c.966 0 1.75.784 1.75 1.75v8.5A1.75 1.75 0 0 1 14.25 14H1.75A1.75 1.75 0 0 1 0 12.25v-8.5C0 2.784.784 2 1.75 2ZM1.5 12.251c0 .138.112.25.25.25h12.5a.25.25 0 0 0 .25-.25V5.809L8.38 9.397a.75.75 0 0 1-.76 0L1.5 5.809v6.442Zm13-8.181v-.32a.25.25 0 0 0-.25-.25H1.75a.25.25 0 0 0-.25.25v.32L8 7.88Z"></path></svg> <a href=mailto:saveau.alexandre@gmail.com>saveau.alexandre@gmail.com</a></div><div class="d-flex flex-items-start flex-wrap"><div class=mb-3><a href=//stackoverflow.com/u/4548500 class="tooltipped tooltipped-se" aria-label="Stack Overflow: 4548500"><svg height=24 viewbox="0 0 120 120" fill=#959da5 xmlns=http://www.w3.org/2000/svg><path d="M84.4 93.8V70.6h7.7v30.9H22.6V70.6h7.7v23.2z" class=st0></path><path d="M38.8 68.4l37.8 7.9 1.6-7.6-37.8-7.9-1.6 7.6zm5-18l35 16.3 3.2-7-35-16.4-3.2 7.1zm9.7-17.2l29.7 24.7 4.9-5.9-29.7-24.7-4.9 5.9zm19.2-18.3l-6.2 4.6 23 31 6.2-4.6-23-31zM38 86h38.6v-7.7H38V86z" class=st1></path></svg><span class=d-none>Stack Overflow</span></a></div></div></div></div></div><div class="px-4 px-lg-7 py-6 border-md-top-0 border-top col-lg-8 col-md-7 col-xl-9 content-container" id=article><div class=mx-auto style=max-width:900px><div class="f4 mb-6"><div class="f4 scoped-text-defaults"><p class=f5><a href=/blog class="text-defaults d-flex flex-items-center"><svg height=16 viewbox="0 0 16 16" class="icon-color octicon v-align-middle mr-2 octicon-chevron-left" version=1.1 width=16 aria-label=include.parent role=img><path d="M9.78 12.78a.75.75 0 0 1-1.06 0L4.47 8.53a.75.75 0 0 1 0-1.06l4.25-4.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042L6.06 8l3.72 3.72a.75.75 0 0 1 0 1.06Z"></path></svg>Blog</a><h1 class="text-defaults lh-condensed f00-light" style=font-weight:600!important>DIY Gradle build optimization</h1><h2 class="text-gray f2-light lh-condensed" style=font-weight:400!important>The definitive guide to Gradle build performance optimization</h2><p class="text-gray mb-5">Published Sep 05, 2018 • Last updated Jun 17, 2020 • 10 min read<div class=article><p><a href=/assets/gradle/abstract-build.png><picture><source sizes="(min-width: 768px) 85vw, 100vw" srcset="/assets/resized/gradle/abstract-build-240-min.avif 240w, /assets/resized/gradle/abstract-build-320-min.avif 320w, /assets/resized/gradle/abstract-build-480-min.avif 480w, /assets/resized/gradle/abstract-build-800-min.avif 800w, /assets/resized/gradle/abstract-build-1600-min.avif 1600w, /assets/resized/gradle/abstract-build-3200-min.avif 3200w, /assets/resized/gradle/abstract-build-min.avif 3840w" type=image/avif><source sizes="(min-width: 768px) 85vw, 100vw" srcset="/assets/resized/gradle/abstract-build-240-min.webp 240w, /assets/resized/gradle/abstract-build-320-min.webp 320w, /assets/resized/gradle/abstract-build-480-min.webp 480w, /assets/resized/gradle/abstract-build-800-min.webp 800w, /assets/resized/gradle/abstract-build-1600-min.webp 1600w, /assets/resized/gradle/abstract-build-3200-min.webp 3200w, /assets/resized/gradle/abstract-build-min.webp 3840w" type=image/webp><source sizes="(min-width: 768px) 85vw, 100vw" srcset="/assets/resized/gradle/abstract-build-240-min.jpg 240w, /assets/resized/gradle/abstract-build-320-min.jpg 320w, /assets/resized/gradle/abstract-build-480-min.jpg 480w, /assets/resized/gradle/abstract-build-800-min.jpg 800w, /assets/resized/gradle/abstract-build-1600-min.jpg 1600w, /assets/resized/gradle/abstract-build-3200-min.jpg 3200w, /assets/resized/gradle/abstract-build-min.jpg 3840w" type=image/jpeg><source sizes="(min-width: 768px) 85vw, 100vw" srcset="/assets/resized/gradle/abstract-build-240.png 240w, /assets/resized/gradle/abstract-build-320.png 320w, /assets/resized/gradle/abstract-build-480.png 480w, /assets/resized/gradle/abstract-build-800.png 800w, /assets/resized/gradle/abstract-build-1600.png 1600w, /assets/resized/gradle/abstract-build-3200.png 3200w, /assets/gradle/abstract-build.png 3840w"><img alt="Abstract Gradle Builds" class="loads article-image" height=2160 src=/assets/resized/gradle/abstract-build-240.png width=3840 loading=lazy></picture></a><div class=text-gray><p class=caption>Beautiful builds. Source: <a href=//gradle.com>gradle.com</a></div><br><p>If you’re anything like me a few months ago, you’ve hit a breaking point. You’re feeling something akin to desperation and you don’t know what to do. You’ve already tried all the classic tricks like fiddling with JVM args and Gradle properties, but to no avail.<p>I’m going to show you how to <em>actually</em> improve your build performance through rigorous analysis and testing. That means I’m not going to throw random hacks at you for copypastaing — if you were hoping for a quick fix, dry up your tears and buckle up, ‘cause we’re about to get into the nitty-gritty by analysing your build to find the bottlenecks.<h2 id=gradle-101>Gradle 101 <a href=#gradle-101 class=header-link>#</a></h2><p>For any job, I think it’s important to understand the fundamentals of your tooling. As an Android developer, the official tool is Gradle, which I feel comes with a lot of misconceptions. To start, let’s dispel some of the common ones.<h3 id=whats-the-difference-between-android-studio-and-gradle>What’s the difference between Android Studio and Gradle? <a href=#whats-the-difference-between-android-studio-and-gradle class=header-link>#</a></h3><p>This is something a lot of people struggle with: they equate Studio with Gradle. While the two tools do talk to each other (hence those annoying “Update the Gradle plugin” dialogs), they have very few similarities. One is a fancy editor, the other an automation tool.<p>Case in point, Gradle couldn’t care less who’s using it — heck, you could be writing code in Notepad++ (ew!) or vim (☠️) and Gradle would be none the wiser. For example, everything could be underlined in red in the IDE, but running <code class="highlighter-rouge language-plaintext">./gradlew assembleDebug</code> works just fine. (That usually means you have to delete the <code class="highlighter-rouge language-plaintext">.idea/libraries</code> folder to force IntelliJ to refresh its indices BTW.)<p><strong>At its core, Gradle primarily cares about the files it gobbles up, and those it spits out.</strong><blockquote><p>Tip: if you want to improve your understanding of Gradle, migrate to the <a href=//github.com/gradle/kotlin-dsl>Kotlin DSL</a> using <a href=//guides.gradle.org/migrating-build-logic-from-groovy-to-kotlin/ >this handy guide</a> — you’ll be able to Ctrl + B to your heart’s content.</blockquote><h3 id=so-whats-the-android-gradle-plugin-then>So what’s the Android Gradle Plugin then? <a href=#so-whats-the-android-gradle-plugin-then class=header-link>#</a></h3><p>Well, Gradle on its own doesn’t actually do anything. If you don’t apply any plugins, you’ll only get built-in tasks like <code class="highlighter-rouge language-plaintext">help</code>, <code class="highlighter-rouge language-plaintext">tasks</code>, and <code class="highlighter-rouge language-plaintext">buildEnvironment</code> — those aren’t going to build your brilliant ideas. Wait, I figured it out! That’s the secret to getting sub-second builds: don’t actually build anything!<p>Jokes aside, Gradle is an <em>automation</em> tool, not necessarily a build tool — it merely operates on input files to generate output files. The rest is whatever you make of it: network requests, running shell scripts… anything you can do from the command line, you can do it from Gradle.<p>However, if you’re going to do something, Gradle needs to know what that something is — that’s where plugins come in: they <em>configure</em> your build. They tell Gradle what units of work, or <em>tasks</em>, are available for you to run.<p><strong>TL;DR: plugins such as the Android Gradle Plugin (AGP) tell Gradle what tasks are available (configuration step) and you then run them (execution step).</strong><h2 id=analysing-your-current-build-performance>Analysing your current build performance <a href=#analysing-your-current-build-performance class=header-link>#</a></h2><p>With the basics out of the way, we’re going to optimize your build scripts, plugin configuration, and task execution. Now, remember how I said this would be an involved process? Well, you’re being involved. 😁<h3 id=add-the-build-scan-plugin>Add the build scan plugin <a href=#add-the-build-scan-plugin class=header-link>#</a></h3><p>While Gradle includes the build scan plugin by default since v2.0, you’ll want to add it manually to ensure you get the latest version and don’t have to agree to the ToS every time.</p><noscript><pre>buildscript { ... }

plugins {
    // Check for the latest version here: https://plugins.gradle.org/plugin/com.gradle.build-scan
    id("com.gradle.build-scan") version "1.16"
}

buildScan {
    setTermsOfServiceUrl("https://gradle.com/terms-of-service")
    setTermsOfServiceAgree("yes")

    // Keep this while optimizing your builds,
    // but then remove it once you're done — unless you want to share all future builds with Gradle.
    // If removed, you can still get build scans by using the --scan option.
    publishAlways()
}
</pre></noscript><script src=//gist.github.com/1a45522316213336b2d92fb280833058.js></script><div class=text-gray style=text-align:center><p class=gist-caption>Simple build scan plugin configuration</div><h3 id=gather-basic-benchmarks>Gather basic benchmarks <a href=#gather-basic-benchmarks class=header-link>#</a></h3><p>Run <code class="highlighter-rouge language-plaintext">./gradlew help</code> twice and then open up the scan for the second run. Ditto for <code class="highlighter-rouge language-plaintext">./gradlew assembleDebug --rerun-tasks</code> and <code class="highlighter-rouge language-plaintext">./gradlew assembleDebug</code>.<blockquote><p>Note: we’re running the build twice to get the best approximation of your real-world build performance, including any caching and other optimizations.<p>If you’re able to invest the extra time and effort to step up your game, <strong><a href=//github.com/gradle/gradle-profiler#benchmarking-a-build>benchmark</a> your builds with the <a href=//github.com/gradle/gradle-profiler>Gradle Profiler</a> to get much more accurate results.</strong></blockquote><p>You now have three benchmarks:<ol><li>Configuration time<li>Clean build execution time<li>Incremental build execution time</ol><p>These are the 3 scenarios we’re going to be optimizing, starting with configuration time.<blockquote><p>Tip: whenever you change something, rerun the build to make sure said change had the impact you thought it did.</blockquote><h3 id=project-stats>Project stats <a href=#project-stats class=header-link>#</a></h3><p>To give you a better idea of how your build should be performing compared to mine, here are the <span data-proofer-ignore=""><a href="//api.codetabs.com/v1/loc?github=SUPERCILEX%2FRobot-Scouter">stats for my test project</a>. </span>(~15 modules and ~20,000 lines of Android related code as of this writing.)<div class=slim-title><div class="d-flex flex-justify-between bg-white border border-gray-light flex-column github-component height-full p-3 rounded-1 text-left"><div><div class="d-flex flex-items-start flex-justify-between mb-1"><h1 class="f4 lh-condensed mb-1"><a href=//github.com/SUPERCILEX/Robot-Scouter class="text-defaults selectively-underline"><svg height=20 viewbox="0 0 16 16" class="icon-color octicon v-align-middle mr-1 octicon-repo" version=1.1 width=20 aria-label=repo role=img fill=#586069><path d="M2 2.5A2.5 2.5 0 0 1 4.5 0h8.75a.75.75 0 0 1 .75.75v12.5a.75.75 0 0 1-.75.75h-2.5a.75.75 0 0 1 0-1.5h1.75v-2h-8a1 1 0 0 0-.714 1.7.75.75 0 1 1-1.072 1.05A2.495 2.495 0 0 1 2 11.5Zm10.5-1h-8a1 1 0 0 0-1 1v6.708A2.486 2.486 0 0 1 4.5 9h8ZM5 12.25a.25.25 0 0 1 .25-.25h3.5a.25.25 0 0 1 .25.25v3.25a.25.25 0 0 1-.4.2l-1.45-1.087a.249.249 0 0 0-.3 0L5.4 15.7a.25.25 0 0 1-.4-.2Z"></path></svg> <span>Robot-Scouter</span> </a><a href=#project-stats class=header-link>#</a></h1></div><div class="text-gray mb-2 ws-normal"><img alt=:robot: class=emoji height=20 src=//github.githubassets.com/images/icons/emoji/unicode/1f916.png width=20 title=:robot:> Easy, efficient, and collaborative FIRST robot scouting</div></div><div class="d-flex f5"><a href="//github.com/trending?l=Kotlin" class="selectively-underline d-inline-block link-gray mr-4"><span class="mr-1 ml-0 repo-language-color" style=background-color:#a97bff></span> <span itemprop=programmingLanguage>Kotlin</span> </a><a href=//github.com/SUPERCILEX/Robot-Scouter/stargazers class="selectively-underline d-inline-block link-gray mr-4"><svg height=16 viewbox="0 0 14 16" class="icon-color octicon mr-1 octicon-star" version=1.1 width=14 aria-hidden=true><path d="M14 6l-4.9-.64L7 1 4.9 5.36 0 6l3.6 3.26L2.67 14 7 11.67 11.33 14l-.93-4.74L14 6z" fill-rule=evenodd></path></svg> <span>108</span> </a><a href=//github.com/SUPERCILEX/Robot-Scouter/network/members class="selectively-underline d-inline-block link-gray mr-4"><svg height=16 viewbox="0 0 10 16" class="icon-color octicon mr-1 octicon-git-branch" version=1.1 width=10 aria-hidden=true><path d="M10 5c0-1.11-.89-2-2-2a1.993 1.993 0 0 0-1 3.72v.3c-.02.52-.23.98-.63 1.38-.4.4-.86.61-1.38.63-.83.02-1.48.16-2 .45V4.72a1.993 1.993 0 0 0-1-3.72C.88 1 0 1.89 0 3a2 2 0 0 0 1 1.72v6.56c-.59.35-1 .99-1 1.72 0 1.11.89 2 2 2 1.11 0 2-.89 2-2 0-.53-.2-1-.53-1.36.09-.06.48-.41.59-.47.25-.11.56-.17.94-.17 1.05-.05 1.95-.45 2.75-1.25S8.95 7.77 9 6.73h-.02C9.59 6.37 10 5.73 10 5zM2 1.8c.66 0 1.2.55 1.2 1.2 0 .65-.55 1.2-1.2 1.2C1.35 4.2.8 3.65.8 3c0-.65.55-1.2 1.2-1.2zm0 12.41c-.66 0-1.2-.55-1.2-1.2 0-.65.55-1.2 1.2-1.2.65 0 1.2.55 1.2 1.2 0 .65-.55 1.2-1.2 1.2zm6-8c-.66 0-1.2-.55-1.2-1.2 0-.65.55-1.2 1.2-1.2.65 0 1.2.55 1.2 1.2 0 .65-.55 1.2-1.2 1.2z" fill-rule=evenodd></path></svg> <span>42</span></a></div></div></div><h2 id=general-optimization>General optimization <a href=#general-optimization class=header-link>#</a></h2><p>Before getting into the specifics, let’s make sure you have the basics down:<ul><li><a href=//gradle.org/releases/ >Latest</a> Gradle version<li><a href=//developer.android.com/studio/releases/gradle-plugin>Latest</a> AGP version<li><a href=//blog.jetbrains.com/kotlin/category/releases/ >Latest</a> Kotlin version<li>Don’t disable the Gradle Daemon<li>Make sure <a href=//docs.gradle.org/current/userguide/build_cache.html><code class="highlighter-rouge language-plaintext">org.gradle.caching=true</code></a> in your <code class="highlighter-rouge language-plaintext">gradle.properties</code> file<li>If possible, enable <a href=//guides.gradle.org/performance/#parallel_execution><code class="highlighter-rouge language-plaintext">org.gradle.parallel</code></a> too, especially if you have multiple modules</ul><blockquote><p>Tip: since keeping track of the latest version of X is always a pain, I’d recommend using a <a href=//github.com/ben-manes/gradle-versions-plugin>version checker plugin</a>. TBH, I’m not sure why this isn’t part of Gradle by default.<p>Bonus: if you’re using an age-old machine, do yourself a favor and toss it out. At the end of the day, crappy hardware equals crappy performance. The only solution there is getting a new machine.</blockquote><h2 id=optimizing-configuration-time>Optimizing configuration time <a href=#optimizing-configuration-time class=header-link>#</a></h2><p>Getting back to business, you should have a build scan that looks something like this:<p><a href=/assets/gradle/build-scan-summary.png><picture><source sizes="(min-width: 768px) 85vw, 100vw" srcset="/assets/resized/gradle/build-scan-summary-240-min.avif 240w, /assets/resized/gradle/build-scan-summary-320-min.avif 320w, /assets/resized/gradle/build-scan-summary-480-min.avif 480w, /assets/resized/gradle/build-scan-summary-800-min.avif 800w, /assets/resized/gradle/build-scan-summary-1600-min.avif 1600w, /assets/resized/gradle/build-scan-summary-3200-min.avif 3200w, /assets/resized/gradle/build-scan-summary-min.avif 3840w" type=image/avif><source sizes="(min-width: 768px) 85vw, 100vw" srcset="/assets/resized/gradle/build-scan-summary-240-min.webp 240w, /assets/resized/gradle/build-scan-summary-320-min.webp 320w, /assets/resized/gradle/build-scan-summary-480-min.webp 480w, /assets/resized/gradle/build-scan-summary-800-min.webp 800w, /assets/resized/gradle/build-scan-summary-1600-min.webp 1600w, /assets/resized/gradle/build-scan-summary-3200-min.webp 3200w, /assets/resized/gradle/build-scan-summary-min.webp 3840w" type=image/webp><source sizes="(min-width: 768px) 85vw, 100vw" srcset="/assets/resized/gradle/build-scan-summary-240-min.jpg 240w, /assets/resized/gradle/build-scan-summary-320-min.jpg 320w, /assets/resized/gradle/build-scan-summary-480-min.jpg 480w, /assets/resized/gradle/build-scan-summary-800-min.jpg 800w, /assets/resized/gradle/build-scan-summary-1600-min.jpg 1600w, /assets/resized/gradle/build-scan-summary-3200-min.jpg 3200w, /assets/resized/gradle/build-scan-summary-min.jpg 3840w" type=image/jpeg><source sizes="(min-width: 768px) 85vw, 100vw" srcset="/assets/resized/gradle/build-scan-summary-240.png 240w, /assets/resized/gradle/build-scan-summary-320.png 320w, /assets/resized/gradle/build-scan-summary-480.png 480w, /assets/resized/gradle/build-scan-summary-800.png 800w, /assets/resized/gradle/build-scan-summary-1600.png 1600w, /assets/resized/gradle/build-scan-summary-3200.png 3200w, /assets/gradle/build-scan-summary.png 3840w"><img alt="Build Scan Summary" class="loads article-image" height=2160 src=/assets/resized/gradle/build-scan-summary-240.png width=3840 loading=lazy></picture></a><div class=text-gray><p class=caption>The Summary tab</div><p>Drilling down into the Performance tab, you’ll find all sorts of details about your build:<p><a href=/assets/gradle/build-scan-performance.png><picture><source sizes="(min-width: 768px) 85vw, 100vw" srcset="/assets/resized/gradle/build-scan-performance-240-min.avif 240w, /assets/resized/gradle/build-scan-performance-320-min.avif 320w, /assets/resized/gradle/build-scan-performance-480-min.avif 480w, /assets/resized/gradle/build-scan-performance-800-min.avif 800w, /assets/resized/gradle/build-scan-performance-1600-min.avif 1600w, /assets/resized/gradle/build-scan-performance-3200-min.avif 3200w, /assets/resized/gradle/build-scan-performance-min.avif 3294w" type=image/avif><source sizes="(min-width: 768px) 85vw, 100vw" srcset="/assets/resized/gradle/build-scan-performance-240-min.webp 240w, /assets/resized/gradle/build-scan-performance-320-min.webp 320w, /assets/resized/gradle/build-scan-performance-480-min.webp 480w, /assets/resized/gradle/build-scan-performance-800-min.webp 800w, /assets/resized/gradle/build-scan-performance-1600-min.webp 1600w, /assets/resized/gradle/build-scan-performance-3200-min.webp 3200w, /assets/resized/gradle/build-scan-performance-min.webp 3294w" type=image/webp><source sizes="(min-width: 768px) 85vw, 100vw" srcset="/assets/resized/gradle/build-scan-performance-240-min.jpg 240w, /assets/resized/gradle/build-scan-performance-320-min.jpg 320w, /assets/resized/gradle/build-scan-performance-480-min.jpg 480w, /assets/resized/gradle/build-scan-performance-800-min.jpg 800w, /assets/resized/gradle/build-scan-performance-1600-min.jpg 1600w, /assets/resized/gradle/build-scan-performance-3200-min.jpg 3200w, /assets/resized/gradle/build-scan-performance-min.jpg 3294w" type=image/jpeg><source sizes="(min-width: 768px) 85vw, 100vw" srcset="/assets/resized/gradle/build-scan-performance-240.png 240w, /assets/resized/gradle/build-scan-performance-320.png 320w, /assets/resized/gradle/build-scan-performance-480.png 480w, /assets/resized/gradle/build-scan-performance-800.png 800w, /assets/resized/gradle/build-scan-performance-1600.png 1600w, /assets/resized/gradle/build-scan-performance-3200.png 3200w, /assets/gradle/build-scan-performance.png 3294w"><img alt="Build Scan Performance" class="loads article-image" height=1061 src=/assets/resized/gradle/build-scan-performance-240.png width=3294 loading=lazy></picture></a><div class=text-gray><p class=caption>The Performance overview tab</div><p>If your configuration time is above 10 seconds (and you don’t have 300+ modules), something is wrong. Otherwise, as long as you’re happy with your configuration time, feel free to skip this section.<blockquote><p>Note: 4 seconds to configure the build is actually terrible — it should only be 1–2 seconds. Unfortunately, the Kotlin plugin <a href=//youtrack.jetbrains.com/issue/KT-26065>incorrectly resolves dependencies at configuration time</a>.</blockquote><p>Ready? Let’s optimize the 💩 out of that configuration time.<h3 id=cache-network-requests>Cache network requests <a href=#cache-network-requests class=header-link>#</a></h3><p>If you’re doing <a href=//stackoverflow.com/a/14804849/4548500>this</a>, scroll up to find the <a href=//docs.gradle.org/current/userguide/dependency_management.html#sec:refreshing-dependencies>better answer</a>.<p>Check the network activity tab and make sure there were no requests:<p><a href=/assets/gradle/build-scan-network.png><picture><source sizes="(min-width: 768px) 85vw, 100vw" srcset="/assets/resized/gradle/build-scan-network-240-min.avif 240w, /assets/resized/gradle/build-scan-network-320-min.avif 320w, /assets/resized/gradle/build-scan-network-480-min.avif 480w, /assets/resized/gradle/build-scan-network-min.avif 687w" type=image/avif><source sizes="(min-width: 768px) 85vw, 100vw" srcset="/assets/resized/gradle/build-scan-network-240-min.webp 240w, /assets/resized/gradle/build-scan-network-320-min.webp 320w, /assets/resized/gradle/build-scan-network-480-min.webp 480w, /assets/resized/gradle/build-scan-network-min.webp 687w" type=image/webp><source sizes="(min-width: 768px) 85vw, 100vw" srcset="/assets/resized/gradle/build-scan-network-240-min.jpg 240w, /assets/resized/gradle/build-scan-network-320-min.jpg 320w, /assets/resized/gradle/build-scan-network-480-min.jpg 480w, /assets/resized/gradle/build-scan-network-min.jpg 687w" type=image/jpeg><source sizes="(min-width: 768px) 85vw, 100vw" srcset="/assets/resized/gradle/build-scan-network-240.png 240w, /assets/resized/gradle/build-scan-network-320.png 320w, /assets/resized/gradle/build-scan-network-480.png 480w, /assets/gradle/build-scan-network.png 687w"><img alt="Build Scan Network Activity" class="loads article-image" height=216 src=/assets/resized/gradle/build-scan-network-240.png width=687 loading=lazy></picture></a><div class=text-gray><p class=caption>Zero is my hero</div><h3 id=dont-do-expensive-operations>Don’t do expensive operations <a href=#dont-do-expensive-operations class=header-link>#</a></h3><p>Look for bottleneck scripts dominating your configuration time. It could be file I/O, processing hashes (Git), or anything else unusually expensive. Basically, you shouldn’t ever be executing stuff at <em>configuration</em> time.<p>Aside from my slow <code class="highlighter-rouge language-plaintext">afterEvaluate</code> block (caused by that Kotlin bug I mentioned earlier), everything else passes the test with flying colors:<p><a href=/assets/gradle/build-scan-script-configuration.png><picture><source sizes="(min-width: 768px) 85vw, 100vw" srcset="/assets/resized/gradle/build-scan-script-configuration-240-min.avif 240w, /assets/resized/gradle/build-scan-script-configuration-320-min.avif 320w, /assets/resized/gradle/build-scan-script-configuration-480-min.avif 480w, /assets/resized/gradle/build-scan-script-configuration-800-min.avif 800w, /assets/resized/gradle/build-scan-script-configuration-1600-min.avif 1600w, /assets/resized/gradle/build-scan-script-configuration-min.avif 2334w" type=image/avif><source sizes="(min-width: 768px) 85vw, 100vw" srcset="/assets/resized/gradle/build-scan-script-configuration-240-min.webp 240w, /assets/resized/gradle/build-scan-script-configuration-320-min.webp 320w, /assets/resized/gradle/build-scan-script-configuration-480-min.webp 480w, /assets/resized/gradle/build-scan-script-configuration-800-min.webp 800w, /assets/resized/gradle/build-scan-script-configuration-1600-min.webp 1600w, /assets/resized/gradle/build-scan-script-configuration-min.webp 2334w" type=image/webp><source sizes="(min-width: 768px) 85vw, 100vw" srcset="/assets/resized/gradle/build-scan-script-configuration-240-min.jpg 240w, /assets/resized/gradle/build-scan-script-configuration-320-min.jpg 320w, /assets/resized/gradle/build-scan-script-configuration-480-min.jpg 480w, /assets/resized/gradle/build-scan-script-configuration-800-min.jpg 800w, /assets/resized/gradle/build-scan-script-configuration-1600-min.jpg 1600w, /assets/resized/gradle/build-scan-script-configuration-min.jpg 2334w" type=image/jpeg><source sizes="(min-width: 768px) 85vw, 100vw" srcset="/assets/resized/gradle/build-scan-script-configuration-240.png 240w, /assets/resized/gradle/build-scan-script-configuration-320.png 320w, /assets/resized/gradle/build-scan-script-configuration-480.png 480w, /assets/resized/gradle/build-scan-script-configuration-800.png 800w, /assets/resized/gradle/build-scan-script-configuration-1600.png 1600w, /assets/gradle/build-scan-script-configuration.png 2334w"><img alt="Build Scan Script Configuration" class="loads article-image" height=980 src=/assets/resized/gradle/build-scan-script-configuration-240.png width=2334 loading=lazy></picture></a><div class=text-gray><p class=caption>Example script configuration time</div><h3 id=dont-use-the-old-task-apis>Don’t use the old task APIs <a href=#dont-use-the-old-task-apis class=header-link>#</a></h3><p>Gradle 4.9 came out with a new API that enables <a href=//docs.gradle.org/current/userguide/task_configuration_avoidance.html>task configuration avoidance</a>. As of this writing, the AGP doesn’t yet support the new APIs, but the upgrade is targeted for v3.3 alpha 9.<p>In the meantime, make sure you <strong>aren’t using any of the <a href=//docs.gradle.org/current/userguide/task_configuration_avoidance.html#sec:old_vs_new_configuration_api_overview>APIs that force task configuration</a></strong> — those will come back to haunt you later.<h3 id=use-the-new-task-apis>Use the new task APIs <a href=#use-the-new-task-apis class=header-link>#</a></h3><p>Conversely, make sure any tasks you create in your build scripts use <code class="highlighter-rouge language-plaintext">register</code> instead of <code class="highlighter-rouge language-plaintext">create</code> (explicitly or implicitly).<h3 id=profile-the-build>Profile the build <a href=#profile-the-build class=header-link>#</a></h3><p>If you’ve found a bottleneck but can’t figure out where the problem is coming from, it’s time to <a href=//github.com/gradle/gradle-profiler>profile your build</a>. I’d recommend using <a href=//github.com/gradle/gradle-profiler#java-flight-recorder>JFR</a> (you’ll need the <a href=//askubuntu.com/a/521154/456255>Oracle JDK</a> and Linux to get Flame graphs):<div class="highlighter-rouge language-bash"><div class=highlight><pre class=highlight><code><span class=nv>$ </span>./gradle-profiler <span class=nt>--profile</span> jfr <span class=nt>--project-dir</span> <span class=s2>"..."</span> <span class=nb>help</span>
</code></pre></div></div><p>For example, you can see how naughty the Kotlin plugin is (<code class="highlighter-rouge language-plaintext">o.j.kotlin.g.i.AndroidSubplugin</code> is forcing Gradle to resolve artifacts):<p><a href=/assets/gradle/build-flame-graph.png><picture><source sizes="(min-width: 768px) 85vw, 100vw" srcset="/assets/resized/gradle/build-flame-graph-240-min.avif 240w, /assets/resized/gradle/build-flame-graph-320-min.avif 320w, /assets/resized/gradle/build-flame-graph-480-min.avif 480w, /assets/resized/gradle/build-flame-graph-800-min.avif 800w, /assets/resized/gradle/build-flame-graph-1600-min.avif 1600w, /assets/resized/gradle/build-flame-graph-min.avif 2847w" type=image/avif><source sizes="(min-width: 768px) 85vw, 100vw" srcset="/assets/resized/gradle/build-flame-graph-240-min.webp 240w, /assets/resized/gradle/build-flame-graph-320-min.webp 320w, /assets/resized/gradle/build-flame-graph-480-min.webp 480w, /assets/resized/gradle/build-flame-graph-800-min.webp 800w, /assets/resized/gradle/build-flame-graph-1600-min.webp 1600w, /assets/resized/gradle/build-flame-graph-min.webp 2847w" type=image/webp><source sizes="(min-width: 768px) 85vw, 100vw" srcset="/assets/resized/gradle/build-flame-graph-240-min.jpg 240w, /assets/resized/gradle/build-flame-graph-320-min.jpg 320w, /assets/resized/gradle/build-flame-graph-480-min.jpg 480w, /assets/resized/gradle/build-flame-graph-800-min.jpg 800w, /assets/resized/gradle/build-flame-graph-1600-min.jpg 1600w, /assets/resized/gradle/build-flame-graph-min.jpg 2847w" type=image/jpeg><source sizes="(min-width: 768px) 85vw, 100vw" srcset="/assets/resized/gradle/build-flame-graph-240.png 240w, /assets/resized/gradle/build-flame-graph-320.png 320w, /assets/resized/gradle/build-flame-graph-480.png 480w, /assets/resized/gradle/build-flame-graph-800.png 800w, /assets/resized/gradle/build-flame-graph-1600.png 1600w, /assets/gradle/build-flame-graph.png 2847w"><img alt="Build Profile Flame Graph" class="loads article-image" height=2159 src=/assets/resized/gradle/build-flame-graph-240.png width=2847 loading=lazy></picture></a><div class=text-gray><p class=caption>🔥</div><p>And if you can’t figure out whose fault it is but don’t think it’s yours, the Gradle team is always happy to take a look at the profiling snapshots: <a href=mailto:performance@gradle.com>performance@gradle.com</a>.<h2 id=optimizing-clean-build-execution-time>Optimizing clean build execution time <a href=#optimizing-clean-build-execution-time class=header-link>#</a></h2><p>To be fair, I haven’t really invested in this area because it doesn’t matter all that much for my day-to-day development. However, there are still a few basic steps you can take to make sure your full builds aren’t excessively slow.<h3 id=tune-jvm-args>Tune JVM args <a href=#tune-jvm-args class=header-link>#</a></h3><p>Ah yes, the classic trick every Gradle build performance article seems to mention. It turns out that unless wildly misconfigured, they don’t matter all that much.<p>In essence, your goal is to minimize garbage collection while also keeping your overall system healthy. So if your heap size is too small, the GC will be thrashing constantly. Too large, and you’ll start running out of system memory for other things like Chrome or IntelliJ. As Thanos said, you want it to be “perfectly balanced, as all things should be.” Minus all the killing.</p><noscript><pre># Start with 2GB, and check how much time is spent garbage collecting relative to the overall build time.
# Add UTF-8 file encoding because of https://github.com/gradle/gradle/issues/2270.
org.gradle.jvmargs=-Xmx2g -Dfile.encoding=UTF-8

# You should almost always enable the build cache.
org.gradle.caching=true

# If it doesn't break your build, parallelize it.
# Otherwise, figure out what tasks are stepping over each other and fix it.
org.gradle.parallel=true
</pre></noscript><script src=//gist.github.com/a8c09c08e7417c8d784840c7a6602600.js></script><p>Now look for “Total garbage collection time” and make sure it doesn’t account for more than 5% of your build:<p><a href=/assets/gradle/build-scan-gc-performance.png><picture><source sizes="(min-width: 768px) 85vw, 100vw" srcset="/assets/resized/gradle/build-scan-gc-performance-240-min.avif 240w, /assets/resized/gradle/build-scan-gc-performance-320-min.avif 320w, /assets/resized/gradle/build-scan-gc-performance-480-min.avif 480w, /assets/resized/gradle/build-scan-gc-performance-800-min.avif 800w, /assets/resized/gradle/build-scan-gc-performance-min.avif 966w" type=image/avif><source sizes="(min-width: 768px) 85vw, 100vw" srcset="/assets/resized/gradle/build-scan-gc-performance-240-min.webp 240w, /assets/resized/gradle/build-scan-gc-performance-320-min.webp 320w, /assets/resized/gradle/build-scan-gc-performance-480-min.webp 480w, /assets/resized/gradle/build-scan-gc-performance-800-min.webp 800w, /assets/resized/gradle/build-scan-gc-performance-min.webp 966w" type=image/webp><source sizes="(min-width: 768px) 85vw, 100vw" srcset="/assets/resized/gradle/build-scan-gc-performance-240-min.jpg 240w, /assets/resized/gradle/build-scan-gc-performance-320-min.jpg 320w, /assets/resized/gradle/build-scan-gc-performance-480-min.jpg 480w, /assets/resized/gradle/build-scan-gc-performance-800-min.jpg 800w, /assets/resized/gradle/build-scan-gc-performance-min.jpg 966w" type=image/jpeg><source sizes="(min-width: 768px) 85vw, 100vw" srcset="/assets/resized/gradle/build-scan-gc-performance-240.png 240w, /assets/resized/gradle/build-scan-gc-performance-320.png 320w, /assets/resized/gradle/build-scan-gc-performance-480.png 480w, /assets/resized/gradle/build-scan-gc-performance-800.png 800w, /assets/gradle/build-scan-gc-performance.png 966w"><img alt="Build Scan GC Performance" class="loads article-image" height=862 src=/assets/resized/gradle/build-scan-gc-performance-240.png width=966 loading=lazy></picture></a><div class=text-gray><p class=caption>4/124 = 3.2%, looks good</div><p>If it’s anything more than that, give the Daemon another GB. Rinse & repeat.<h3 id=report-excessively-slow-tasks-to-the-offending-parties-and-disable-them-if-possible>Report excessively slow tasks to the offending parties (and disable them if possible) <a href=#report-excessively-slow-tasks-to-the-offending-parties-and-disable-them-if-possible class=header-link>#</a></h3><p>If a single task is dominating your build, something is wrong. For example, the Firebase Performance plugin is notoriously slow — something that’s painfully obvious in the timeline view:<p><a href=/assets/gradle/build-scan-timeline-bad.png><picture><source sizes="(min-width: 768px) 85vw, 100vw" srcset="/assets/resized/gradle/build-scan-timeline-bad-240-min.avif 240w, /assets/resized/gradle/build-scan-timeline-bad-320-min.avif 320w, /assets/resized/gradle/build-scan-timeline-bad-480-min.avif 480w, /assets/resized/gradle/build-scan-timeline-bad-800-min.avif 800w, /assets/resized/gradle/build-scan-timeline-bad-1600-min.avif 1600w, /assets/resized/gradle/build-scan-timeline-bad-3200-min.avif 3200w, /assets/resized/gradle/build-scan-timeline-bad-min.avif 3839w" type=image/avif><source sizes="(min-width: 768px) 85vw, 100vw" srcset="/assets/resized/gradle/build-scan-timeline-bad-240-min.webp 240w, /assets/resized/gradle/build-scan-timeline-bad-320-min.webp 320w, /assets/resized/gradle/build-scan-timeline-bad-480-min.webp 480w, /assets/resized/gradle/build-scan-timeline-bad-800-min.webp 800w, /assets/resized/gradle/build-scan-timeline-bad-1600-min.webp 1600w, /assets/resized/gradle/build-scan-timeline-bad-3200-min.webp 3200w, /assets/resized/gradle/build-scan-timeline-bad-min.webp 3839w" type=image/webp><source sizes="(min-width: 768px) 85vw, 100vw" srcset="/assets/resized/gradle/build-scan-timeline-bad-240-min.jpg 240w, /assets/resized/gradle/build-scan-timeline-bad-320-min.jpg 320w, /assets/resized/gradle/build-scan-timeline-bad-480-min.jpg 480w, /assets/resized/gradle/build-scan-timeline-bad-800-min.jpg 800w, /assets/resized/gradle/build-scan-timeline-bad-1600-min.jpg 1600w, /assets/resized/gradle/build-scan-timeline-bad-3200-min.jpg 3200w, /assets/resized/gradle/build-scan-timeline-bad-min.jpg 3839w" type=image/jpeg><source sizes="(min-width: 768px) 85vw, 100vw" srcset="/assets/resized/gradle/build-scan-timeline-bad-240.png 240w, /assets/resized/gradle/build-scan-timeline-bad-320.png 320w, /assets/resized/gradle/build-scan-timeline-bad-480.png 480w, /assets/resized/gradle/build-scan-timeline-bad-800.png 800w, /assets/resized/gradle/build-scan-timeline-bad-1600.png 1600w, /assets/resized/gradle/build-scan-timeline-bad-3200.png 3200w, /assets/gradle/build-scan-timeline-bad.png 3839w"><img alt="Build Scan Timeline" class="loads article-image" height=1466 src=/assets/resized/gradle/build-scan-timeline-bad-240.png width=3839 loading=lazy></picture></a><div class=text-gray><p class=caption>Ouch</div><p>When the task isn’t needed for your dev builds, don’t run it. You can do that by either not applying the plugin, or disabling the task itself:</p><noscript><pre>val isCi = System.getenv("CI") != null
val Project.isReleaseBuild get() = hasProperty("relBuild") || isCi

if (isReleaseBuild) apply(plugin = "com.google.firebase.firebase-perf")
// OR
project.tasks.named("transformClassesWithFirebasePerformancePluginForDebug").configure {
    enabled = isReleaseBuild
}
</pre></noscript><script src=//gist.github.com/054d90c063605c3a3d1ff611ed3d9111.js></script><p>Now, you’ll have an evenly spread out timeline with the longest tasks rightfully being those like <code class="highlighter-rouge language-plaintext">compileDebugKotlin</code>:<p><a href=/assets/gradle/build-scan-timeline-good.png><picture><source sizes="(min-width: 768px) 85vw, 100vw" srcset="/assets/resized/gradle/build-scan-timeline-good-240-min.avif 240w, /assets/resized/gradle/build-scan-timeline-good-320-min.avif 320w, /assets/resized/gradle/build-scan-timeline-good-480-min.avif 480w, /assets/resized/gradle/build-scan-timeline-good-800-min.avif 800w, /assets/resized/gradle/build-scan-timeline-good-1600-min.avif 1600w, /assets/resized/gradle/build-scan-timeline-good-min.avif 3194w" type=image/avif><source sizes="(min-width: 768px) 85vw, 100vw" srcset="/assets/resized/gradle/build-scan-timeline-good-240-min.webp 240w, /assets/resized/gradle/build-scan-timeline-good-320-min.webp 320w, /assets/resized/gradle/build-scan-timeline-good-480-min.webp 480w, /assets/resized/gradle/build-scan-timeline-good-800-min.webp 800w, /assets/resized/gradle/build-scan-timeline-good-1600-min.webp 1600w, /assets/resized/gradle/build-scan-timeline-good-min.webp 3194w" type=image/webp><source sizes="(min-width: 768px) 85vw, 100vw" srcset="/assets/resized/gradle/build-scan-timeline-good-240-min.jpg 240w, /assets/resized/gradle/build-scan-timeline-good-320-min.jpg 320w, /assets/resized/gradle/build-scan-timeline-good-480-min.jpg 480w, /assets/resized/gradle/build-scan-timeline-good-800-min.jpg 800w, /assets/resized/gradle/build-scan-timeline-good-1600-min.jpg 1600w, /assets/resized/gradle/build-scan-timeline-good-min.jpg 3194w" type=image/jpeg><source sizes="(min-width: 768px) 85vw, 100vw" srcset="/assets/resized/gradle/build-scan-timeline-good-240.png 240w, /assets/resized/gradle/build-scan-timeline-good-320.png 320w, /assets/resized/gradle/build-scan-timeline-good-480.png 480w, /assets/resized/gradle/build-scan-timeline-good-800.png 800w, /assets/resized/gradle/build-scan-timeline-good-1600.png 1600w, /assets/gradle/build-scan-timeline-good.png 3194w"><img alt="Build Scan Timeline" class="loads article-image" height=1644 src=/assets/resized/gradle/build-scan-timeline-good-240.png width=3194 loading=lazy></picture></a><div class=text-gray><p class=caption>Balance</div><p>Here’s another example: I noticed that builds running <code class="highlighter-rouge language-plaintext">installDebug</code> were excessively slow because of <code class="highlighter-rouge language-plaintext">makeApkFromBundleForDebug</code>, so I <a href=//issuetracker.google.com/issues/112180979>reported it</a>. The Studio team found multiple bugs and missed performance optimizations.<h2 id=optimizing-incremental-build-execution-time>Optimizing incremental build execution time <a href=#optimizing-incremental-build-execution-time class=header-link>#</a></h2><p>The importance of incremental builds is second only to configuration time. You’ll be running them dozens (if not hundreds) of times a day, so optimizing them is key.<h3 id=ensure-no-incremental-tasks-are-running>Ensure no incremental tasks are running <a href=#ensure-no-incremental-tasks-are-running class=header-link>#</a></h3><p>If you haven’t changed anything, nothing should happen when you rerun a build. The Studio team is doing a great job on this front, but the Play Services team sadly still hasn’t made their <code class="highlighter-rouge language-plaintext">GoogleServicesTask</code> incremental:<p><a href=/assets/gradle/build-scan-incremental-timeline.png><picture><source sizes="(min-width: 768px) 85vw, 100vw" srcset="/assets/resized/gradle/build-scan-incremental-timeline-240-min.avif 240w, /assets/resized/gradle/build-scan-incremental-timeline-320-min.avif 320w, /assets/resized/gradle/build-scan-incremental-timeline-480-min.avif 480w, /assets/resized/gradle/build-scan-incremental-timeline-800-min.avif 800w, /assets/resized/gradle/build-scan-incremental-timeline-1600-min.avif 1600w, /assets/resized/gradle/build-scan-incremental-timeline-3200-min.avif 3200w, /assets/resized/gradle/build-scan-incremental-timeline-min.avif 3263w" type=image/avif><source sizes="(min-width: 768px) 85vw, 100vw" srcset="/assets/resized/gradle/build-scan-incremental-timeline-240-min.webp 240w, /assets/resized/gradle/build-scan-incremental-timeline-320-min.webp 320w, /assets/resized/gradle/build-scan-incremental-timeline-480-min.webp 480w, /assets/resized/gradle/build-scan-incremental-timeline-800-min.webp 800w, /assets/resized/gradle/build-scan-incremental-timeline-1600-min.webp 1600w, /assets/resized/gradle/build-scan-incremental-timeline-3200-min.webp 3200w, /assets/resized/gradle/build-scan-incremental-timeline-min.webp 3263w" type=image/webp><source sizes="(min-width: 768px) 85vw, 100vw" srcset="/assets/resized/gradle/build-scan-incremental-timeline-240-min.jpg 240w, /assets/resized/gradle/build-scan-incremental-timeline-320-min.jpg 320w, /assets/resized/gradle/build-scan-incremental-timeline-480-min.jpg 480w, /assets/resized/gradle/build-scan-incremental-timeline-800-min.jpg 800w, /assets/resized/gradle/build-scan-incremental-timeline-1600-min.jpg 1600w, /assets/resized/gradle/build-scan-incremental-timeline-3200-min.jpg 3200w, /assets/resized/gradle/build-scan-incremental-timeline-min.jpg 3263w" type=image/jpeg><source sizes="(min-width: 768px) 85vw, 100vw" srcset="/assets/resized/gradle/build-scan-incremental-timeline-240.png 240w, /assets/resized/gradle/build-scan-incremental-timeline-320.png 320w, /assets/resized/gradle/build-scan-incremental-timeline-480.png 480w, /assets/resized/gradle/build-scan-incremental-timeline-800.png 800w, /assets/resized/gradle/build-scan-incremental-timeline-1600.png 1600w, /assets/resized/gradle/build-scan-incremental-timeline-3200.png 3200w, /assets/gradle/build-scan-incremental-timeline.png 3263w"><img alt="Build Scan Incremental Timeline" class="loads article-image" height=1136 src=/assets/resized/gradle/build-scan-incremental-timeline-240.png width=3263 loading=lazy></picture></a><div class=text-gray><p class=caption>C'mon, we're sooo close!</div><p>If there are tasks you don’t think should be running, click on them to see why the cache was invalidated. You’re most likely configuring your build non-deterministically and accidentally changing inputs each time.<h3 id=minimize-annotation-processor-use-or-use-incremental-ones>Minimize annotation processor use (or use <a href=//github.com/gradle/gradle/issues/5277>incremental ones</a>) <a href=#minimize-annotation-processor-use-or-use-incremental-ones class=header-link>#</a></h3><p>Are you using Glide modules just for the prettier <code class="highlighter-rouge language-plaintext">RequestOptions</code> syntax? Ask yourself this: <em>is losing incremental compilation really worth it?</em> For me, the answer is no.<h3 id=modularize-your-build>Modularize your build <a href=#modularize-your-build class=header-link>#</a></h3><p>Yes, I know this one is also a tough cookie, but it’ll pay off in the end. You’ll not only improve build performance, but also code quality by enforcing clean separation of concerns between your different feature modules.<blockquote><p>Caveat: the Kotlin plugin doesn’t yet support <a href=//blog.gradle.org/incremental-compiler-avoidance>compilation avoidance</a> so you won’t see huge performance benefits when editing non-leaf modules as of this writing. To be fair, this is <a href=//github.com/gradle/gradle/issues/5226#issuecomment-393647155>Gradle’s fault</a>.</blockquote><h3 id=replace-api-dependencies-with-implementation-wherever-possible>Replace <code class="highlighter-rouge language-plaintext">api</code> dependencies with <code class="highlighter-rouge language-plaintext">implementation</code> wherever possible <a href=#replace-api-dependencies-with-implementation-wherever-possible class=header-link>#</a></h3><p>Once you’ve modularized your build, you’ll want to have as many leaf modules as possible. Otherwise, their children have to be recompiled whenever they change.<h2 id=next-steps>Next steps <a href=#next-steps class=header-link>#</a></h2><p>While you may have made performance gains today, that doesn’t mean you won’t mess it up again tomorrow. (That was super cynical of me, sorry 😊.) <strong>Share this article with your colleagues</strong> — make sure they aren’t accidentally breaking the rules established throughout the guide.<p>I’d also recommend taking advantage of the <a href=//gradle.com/enterprise/trial/ >Gradle Enterprise free trial</a> to collect a few weeks worth of data and make sure everyone on your team is getting the best possible performance.<hr><p>Well, that’s a wrap. I hope I’ve given you the tools to fight back growing build times and maximize your productivity.</div></div></div></div></div></div><footer class=text-defaults><small>Copyright © 2018-2025 Alex Saveau</small> <small><a href=//github.com/SUPERCILEX/personal-website>Source</a> | <a href=//twitter.com/SUPERCILEX>Twitter</a> | <a href=#top>Back to top</a></small></footer>